<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Threshold selection ‚Ä¢ mev</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Threshold selection">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.10007</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a></li>
    <li><a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection</a></li>
    <li><a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a></li>
    <li><a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a></li>
    <li><a class="dropdown-item" href="../articles/mev-vignette.html">Exact unconditional sampling from max-stable random vectors</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Threshold selection</h1>
                        <h4 data-toc-skip class="author">L√©o
Belzile</h4>
            
            <h4 data-toc-skip class="date">2025-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/vignettes/02-threshold.Rmd" class="external-link"><code>vignettes/02-threshold.Rmd</code></a></small>
      <div class="d-none name"><code>02-threshold.Rmd</code></div>
    </div>

    
    
<p>The generalized Pareto (GP) distribution with scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÉ</mi><mo>‚àà</mo><msub><mi>‚Ñù</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">\sigma \in \mathbb{R}_{+}</annotation></semantics></math>
and shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œæ</mi><mo>‚àà</mo><mi>‚Ñù</mi></mrow><annotation encoding="application/x-tex">\xi \in \mathbb{R}</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>‚àí</mo><msubsup><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo>+</mo><mi>Œæ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>x</mi><mi>œÉ</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>+</mo><mrow><mi>‚àí</mi><mn>1</mn><mi>/</mi><mi>Œæ</mi></mrow></msubsup><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>Œæ</mi><mo>‚â†</mo><mn>0</mn><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mi>x</mi><mi>œÉ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>Œæ</mi><mo>=</mo><mn>0</mn><mi>.</mi></mtd></mtr></mtable></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
  G(x)  = \begin{cases}
1-\left\{1+\xi \left(\frac{x}{\sigma}\right)\right\}_{+}^{-1/\xi}, &amp;  \xi \neq 0,
\\ 1-\exp \left(-{x}{\sigma}\right),&amp;  \xi = 0.
\end{cases}
 \end{align*}</annotation></semantics></math> The range of the
generalized Pareto distribution is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mi>‚àí</mi><mi>œÉ</mi><mi>/</mi><mi>Œæ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">[0, -\sigma/\xi)</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œæ</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi &lt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñù</mi><mo>+</mo></msub><annotation encoding="application/x-tex">\mathbb{R}_{+}</annotation></semantics></math>
otherwise.</p>
<p>Why is the generalized Pareto distribution so central to
peaks-over-threshold analysis? The conditional distribution of
exceedances over a threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>&lt;</mo><msup><mi>x</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">u &lt; x^*</annotation></semantics></math>
converges to a generalized Pareto distribution as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
converges to the endpoint of the distribution,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><munder><mo>lim</mo><mrow><mi>u</mi><mo>‚Üí</mo><msup><mi>x</mi><mo>*</mo></msup></mrow></munder><mfrac><mrow><mn>1</mn><mo>‚àí</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><msub><mi>a</mi><mi>u</mi></msub><mo>+</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>‚àí</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mn>1</mn><mo>‚àí</mo><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\lim_{u \to x^*} \frac{1-F(xa_u+u)}{1-F(u)} = 1-H(x),
\end{align*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(x)</annotation></semantics></math>
is the distribution function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ùñ¶</mi><mi>ùñØ</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œæ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathsf{GP}(1, \xi)</annotation></semantics></math>.</p>
<p>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>‚àº</mo><mrow><mi>ùñ¶</mi><mi>ùñØ</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÉ</mi><mo>,</mo><mi>Œæ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X \sim \mathsf{GP}(\sigma, \xi)</annotation></semantics></math>,
straightforward calculations show that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>‚àí</mo><mi>u</mi><mo>‚à£</mo><mi>X</mi><mo>&gt;</mo><mi>u</mi><mo>‚àº</mo><mrow><mi>ùñ¶</mi><mi>ùñØ</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÉ</mi><mo>+</mo><mi>Œæ</mi><mi>u</mi><mo>,</mo><mi>Œæ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X-u \mid X&gt;u \sim \mathsf{GP}(\sigma + \xi u, \xi)</annotation></semantics></math>
for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>‚àà</mo><mi>‚Ñù</mi></mrow><annotation encoding="application/x-tex">u \in \mathbb{R}</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÉ</mi><mo>+</mo><mi>Œæ</mi><mi>u</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma+\xi u&gt;0</annotation></semantics></math>,
meaning that conditional exceedances above a threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
also follow a generalized Pareto distribution. This property is termed
threshold-stability.</p>
<p>The limiting distribution of threshold exceedances is generalized
Pareto as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>‚Üí</mo><msup><mi>x</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">u \to x^*</annotation></semantics></math>
but, in practice, we must choose a finite threshold in order to have
enough exceedances to draw inference. Since the scaling constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>u</mi></msub><annotation encoding="application/x-tex">a_u</annotation></semantics></math>
is unknown, we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>‚à£</mo><mi>X</mi><mo>&gt;</mo><mi>u</mi><mover><mo>‚àº</mo><mo accent="false">‚ãÖ</mo></mover><mrow><mi>ùñ¶</mi><mi>ùñØ</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œÉ</mi><mi>u</mi></msub><mo>,</mo><mi>Œæ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X \mid X &gt; u \stackrel{\cdot}{\sim} \mathsf{GP}(\sigma_u, \xi)</annotation></semantics></math>.
The term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1-F(u)</annotation></semantics></math>
in the denominator is the fraction of points exceeding the threshold,
which has a binomial distribution.</p>
<p>Threshold selection is subtle and it is common to select a high
percentile of the data, say the 95% value, as the threshold, even if
this is asymptotically incorrect, as in this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>/</mi><mi>n</mi><mo>‚Üõ</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k/n \nrightarrow 0</annotation></semantics></math>
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚Üí</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">n \to \infty</annotation></semantics></math>.
Most approaches for threshold selection rely on properties of the
generalized Pareto distribution (moments, threshold-stability) to
determine a region within which the asymptotic distribution fits the
data well and the parameter estimates are stable.</p>
<p>Below, we focus on recent graphical selection tools for likelihood
based inference; mixture models are reviewed in <span class="citation">Scarrott and MacDonald (2012)</span> and are available
in the package <code>evmix</code>.</p>
<div class="section level2">
<h2 id="threshold-stability-plots">Threshold stability plots<a class="anchor" aria-label="anchor" href="#threshold-stability-plots"></a>
</h2>
<p>Consider a sequence of ordered candidate thresholds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>&lt;</mo><mi>‚ãØ</mi><mo>&lt;</mo><msub><mi>u</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">u_1 &lt; \cdots &lt; u_k</annotation></semantics></math>;
one of the most widely used tools for threshold selection is the
threshold-stability plots of <span class="citation">Davison and Smith
(1990)</span>. These show the point estimates of the shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œæ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
and the modified scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÉ</mi><msub><mi>u</mi><mi>i</mi></msub></msub><mo>‚àí</mo><mi>Œæ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_{u_i}-\xi u_i</annotation></semantics></math>,
which should be constant for any threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>j</mi></msub><mo>&gt;</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_{j} &gt;u_i</annotation></semantics></math>
assuming that the generalized Pareto above
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>i</mi></msub><annotation encoding="application/x-tex">u_i</annotation></semantics></math>
holds exactly. In addition to the point estimates, the asymptotic
pointwise 95% Wald confidence intervals are displayed; the standard
errors are obtained from the observed information matrix. While these
are displayed by many packages, notably <code>extRemes</code>,
<code>ismev</code> and <code>evd</code> , <code>mev</code> allows you to
use profile likelihood based confidence intervals, which typically offer
better coverage and capture some of the asymmetry of the distribution.
The <code>mev</code> package functions for producing threshold stability
plots are <code>tstab.gpd</code> and <code>tstab.pp</code> for
respectively the generalized Pareto and Poisson process likelihoods.</p>
<p>Parameter stability plots can be difficult to interpret because the
confidence intervals are pointwise rather than simultaneous (each fit
likewise uses an overlapping portion of the data). The plots also ignore
changes in the estimated parameters due to the penultimate
approximation.</p>
</div>
<div class="section level2">
<h2 id="wadsworths-diagnostics-white-noise-process-and-simultaneous-threshold-stability-plots">Wadsworth‚Äôs diagnostics: white noise process and simultaneous
threshold stability plots<a class="anchor" aria-label="anchor" href="#wadsworths-diagnostics-white-noise-process-and-simultaneous-threshold-stability-plots"></a>
</h2>
<p>The problem with the threshold stability plots lies in the point-wise
nature of the estimate. Assuming a superposition of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
Poisson processes, <span class="citation">Wadsworth (2016)</span>
derives the limiting distribution of the maximum likelihood estimators
from the Poisson process for overlapping windows as the number of
windows
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>‚Üí</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">k \to \infty</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>k</mi></msub><mo>‚Üí</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">n_k \to \infty</annotation></semantics></math>.
The joint asymptotic Gaussian distribution allows <span class="citation">Wadsworth (2016)</span> to propose two additional
diagnostics: a white noise sequence of differences in estimates of the
shape, standardized to have unit variance. The variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Œæ</mi><mi>i</mi><mo>*</mo></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Œæ</mi><mo accent="true">ÃÇ</mo></mover><msub><mi>u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></msub><mo>‚àí</mo><msub><mover><mi>Œæ</mi><mo accent="true">ÃÇ</mo></mover><msub><mi>u</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mo stretchy="false" form="prefix">{</mo><msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>I</mi><msub><mi>u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow><mi>‚àí</mi><mn>1</mn></mrow></msubsup><mo>‚àí</mo><msubsup><mi>I</mi><msub><mi>u</mi><mi>i</mi></msub><mrow><mi>‚àí</mi><mn>1</mn></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>Œæ</mi><mo>,</mo><mi>Œæ</mi></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\xi^*_i=(\hat{\xi}_{u_{i+1}}-\hat{\xi}_{u_i})/\{(I^{-1}_{u_{i+1}}-I^{-1}_{u_{i}})_{\xi,\xi}^{1/2}\}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><msub><mi>u</mi><mi>i</mi></msub></msub><annotation encoding="application/x-tex">I_{u_{i}}</annotation></semantics></math>
is the Fisher information of the Poisson process likelihood for
exceedances above
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>i</mi></msub><annotation encoding="application/x-tex">u_i</annotation></semantics></math>,
should form a white-noise sequence of independent variables centered
around the origin; systematic deviations are indicative of inadequacy.
To formally test the hypothesis, a likelihood ratio test can be used
assuming a simple alternative, namely a single change point at threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>j</mi></msub><annotation encoding="application/x-tex">u_j</annotation></semantics></math>.
The null hypothesis is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">H</mi><mn>0</mn></msub><mo>:</mo><msubsup><mi>Œæ</mi><mi>i</mi><mo>*</mo></msubsup><mover><mo>‚àº</mo><mo accent="false">‚ãÖ</mo></mover><mrow><mi>ùñ≠</mi><mi>ùóà</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{H}_0: \xi_i^* \stackrel{\cdot}{\sim} \mathsf{No}(0,1)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i=1, \ldots, k-1</annotation></semantics></math>
against the alternative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">H</mi><mi>a</mi></msub><mo>:</mo><msubsup><mi>Œæ</mi><mi>i</mi><mo>*</mo></msubsup><mo>‚àº</mo><mrow><mi>ùñ≠</mi><mi>ùóà</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≤</mi><mo>,</mo><mi>œÉ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>j</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{H}_a: \xi^*_i \sim \mathsf{No}(\beta, \sigma) (i=1, \ldots, j-1)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Œæ</mi><mi>i</mi><mo>*</mo></msubsup><mo>‚àº</mo><mrow><mi>ùñ≠</mi><mi>ùóà</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\xi^*_i \sim \mathsf{No}(0,1)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j, \ldots, k-1</annotation></semantics></math>.
This alternative is motivated by results on model misspecification <span class="citation">(White 1982)</span>, which suggest that the asymptotic
distribution may still be Gaussian, but with a different mean and
variance. This can be used to automate threshold selection, by picking
the smallest threshold for which the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-value
is above the level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.
The function <code>W.diag</code> returns diagnostics plots (for the
likelihood ratio statistic path, the white noise process and threshold
stability along with asymptotic simultaneous confidence intervals) for
non-homogeneous Poisson process model and for the bivariate exponential
and the over a sequence of thresholds, specified using <code>q1</code>,
<code>q2</code> and <code>k</code>. The argument <code>M</code> is a
tuning parameter that can be chosen in a way such that the parameters of
the non-homogeneous Poisson process likelihood coincide with those of
the generalized extreme value distribution for blocks of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>;
see <span class="citation">Coles (2001)</span> to this effect.</p>
<p>A main criticism of the proposals of <span class="citation">Wadsworth
(2016)</span> is their lack of robustness. For the asymptotic result to
be approximately valid, the number of thresholds must be large, which
implicitly requires large samples for each superposed point process.
Moreover, the estimated difference in Fisher information matrices often
fails to be positive definite in practice. The procedure is highly
sensitive to the choice of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
Changing the set of thresholds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÆ</mi><annotation encoding="application/x-tex">\boldsymbol{u}</annotation></semantics></math>
under consideration leads to potentially completely different parameter
estimates being chosen by the automated procedure.</p>
</div>
<div class="section level2">
<h2 id="changepoint-tests-based-on-penultimate-approximation">Changepoint tests based on penultimate approximation<a class="anchor" aria-label="anchor" href="#changepoint-tests-based-on-penultimate-approximation"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(x)</annotation></semantics></math>
denote a thrice-differentiable distribution function with endpoint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>
and density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>.
Define the reciprocal hazard function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>‚àí</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mi>/</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r(x) = \{1-F(x)\}/f(x)</annotation></semantics></math>.
The existence of the limit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œæ</mi><mi>‚àû</mi></msub><mo>=</mo><msub><mo>lim</mo><mrow><mi>n</mi><mo>‚Üí</mo><mi>‚àû</mi></mrow></msub><mi>s</mi><mi>‚Ä≤</mi><mo stretchy="false" form="prefix">{</mo><msub><mi>b</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\xi_{\infty} = \lim_{n \to \infty} s'\{b_n\}</annotation></semantics></math>
is necessary and sufficient for convergence to an extreme value
distribution and <span class="citation">Smith (1987)</span> shows that
there exists
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
such that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mn>1</mn><mo>‚àí</mo><mi>F</mi><mo stretchy="false" form="prefix">{</mo><mi>u</mi><mo>+</mo><mi>x</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><mrow><mn>1</mn><mo>‚àí</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><msubsup><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo>+</mo><mi>x</mi><mi>r</mi><mi>‚Ä≤</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>+</mo><mrow><mi>‚àí</mi><mn>1</mn><mi>/</mi><mi>r</mi><mi>‚Ä≤</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msubsup><mo>,</mo><mspace width="2.0em"></mspace><mi>u</mi><mo>&lt;</mo><mi>y</mi><mo>&lt;</mo><mi>u</mi><mo>+</mo><mi>x</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
 \frac{1-F\{u+xr(u)\}}{1-F(u)} = \left\{1+xr'(y)\right\}_{+}^{-1/r'(y)}, \qquad u &lt; y &lt; u+xr(u),
\end{align*}</annotation></semantics></math> unless
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>‚Ä≤</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r'(x)</annotation></semantics></math>
is constant. The penultimate shape parameter for the generalized Pareto
distribution is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>‚Ä≤</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r'(u)</annotation></semantics></math>,
but the true shape parameter lies between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>‚Ä≤</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r'(u)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œæ</mi><mi>‚àû</mi></msub><annotation encoding="application/x-tex">\xi_{\infty}</annotation></semantics></math>.</p>
<p>When we fit the limiting parametric models to finite samples, maximum
likelihood estimates of the shape parameter will be closer to their
penultimate counterparts than to the limiting value and we can expect
them to vary as we increase the threshold.</p>
<p><span class="citation">Northrop and Coleman (2014)</span> adapt the
idea of <span class="citation">Wadsworth and Tawn (2012)</span> and fit
a generalized Pareto model with piecewise constant shape to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
different thresholds; continuity constraints at the thresholds impose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k-1</annotation></semantics></math>
restrictions on scale parameters, so the model only has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math>
parameters. A score test can be used to test the hypothesis of equal
shape and it only requires evaluation of the model under the null
hypothesis that a generalized Pareto distribution is valid above all
thresholds. A diagnostic plot is obtained by plotting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-values
against threshold. One can then choose to take, e.g., (a) the lowest
threshold at which the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-value
is non-significant, or (b) the lowest threshold at which the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-values
for all higher thresholds are non-significant: under the null
hypothesis, there is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mi>%</mi></mrow><annotation encoding="application/x-tex">\alpha\%</annotation></semantics></math>
probability of rejection at any given threshold. The function
<code>NC.diag</code> computes the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-value
of the score test as a function of the threshold.</p>
</div>
<div class="section level2">
<h2 id="extended-generalized-pareto">Extended generalized Pareto<a class="anchor" aria-label="anchor" href="#extended-generalized-pareto"></a>
</h2>
<p><span class="citation">Papastathopoulos and Tawn (2013)</span>
propose three extended generalized Pareto distributions: for example,
the third extended generalized Pareto model has distribution function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>‚àí</mo><msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œæ</mi><mi>x</mi><mi>/</mi><mi>œÉ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mi>‚àí</mi><mn>1</mn><mi>/</mi><mi>Œæ</mi></mrow></msubsup><msup><mo stretchy="false" form="postfix">}</mo><mi>Œ∫</mi></msup></mrow><annotation encoding="application/x-tex">\{1-(1+\xi x/\sigma)^{-1/\xi}_{+}\}^{\kappa}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x &gt;0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\kappa &gt; 0</annotation></semantics></math>.
Each family reduces to the generalized Pareto when the additional
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa=1</annotation></semantics></math>
and share the same tail index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œæ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>,
the extended generalized Pareto provide more flexibility for modelling
departures from the limiting form. Standard parameter stability plots
can be used to find a region in which
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>‚âà</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa \approx 1</annotation></semantics></math>
and the shape parameter stabilizes. The additional parameter gives
flexibility for modelling departures from the limiting distribution and
the hope is one can fit to exceedances over lower threshold and increase
the number of points to which the distribution is fitted. The stability
plots, obtained through <code>tstab.egp</code>, suffer from the same
caveats as classical diagnostics.</p>
</div>
<div class="section level2">
<h2 id="robust-selection">Robust selection<a class="anchor" aria-label="anchor" href="#robust-selection"></a>
</h2>
<p>The extreme value distributions have unbounded influence functions
and outliers can strongly affect the estimate of the shape. <span class="citation">Dupuis (1999)</span> proposes an optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>-robust
estimator of the generalized Pareto parameters. Points that are outlying
or for which the fit is poor are downweighted; if the weights for the
largest observations are very low, this suggests that the threshold is
too low. While there is no guarantee that observations that were
simulated from a generalized Pareto distributed would not be
downweighted, systematic downweighting of the largest exceedances may be
indicative of poor fit.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>We are now ready to go back to the Maiquetia data and try to select a
reasonable threshold. To this effect, we select a sequence of candidate
thresholds and run the procedures described above.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lbelzile.github.io/mev/" class="external-link">mev</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">maiquetia</span>, package <span class="op">=</span> <span class="st">"mev"</span><span class="op">)</span></span>
<span><span class="va">day</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1961-01-01"</span><span class="op">)</span>, </span>
<span>                to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1999-12-31"</span><span class="op">)</span>, </span>
<span>                by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">nzrain</span> <span class="op">&lt;-</span> <span class="va">maiquetia</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">day</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1999</span> <span class="op">&amp;</span> <span class="va">maiquetia</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="co"># Keep non-zero rainfall, exclude 1999 observations</span></span>
<span><span class="va">nzrain</span> <span class="op">&lt;-</span> <span class="va">maiquetia</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">day</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">99</span> <span class="op">&amp;</span> <span class="va">maiquetia</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">thcan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">nzrain</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.99</span>, length.out <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tstab.gpd.html">tstab.gpd</a></span><span class="op">(</span>xdat <span class="op">=</span> <span class="va">nzrain</span>, </span>
<span>          thresh <span class="op">=</span> <span class="va">thcan</span>, </span>
<span>          method <span class="op">=</span> <span class="st">"profile"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in x$mle[, 1] + c(-0.1, 0.1): longer object length is not a multiple of</span></span>
<span><span class="co">#&gt; shorter object length</span></span></code></pre></div>
<p><img src="02-threshold_files/figure-html/tstabplots-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; Warning in x$mle[, 2] + c(-0.1, 0.1): longer object length is not a multiple of</span></span>
<span><span class="co">#&gt; shorter object length</span></span></code></pre>
<p><img src="02-threshold_files/figure-html/tstabplots-2.png" width="90%" style="display: block; margin: auto;"></p>
<p>Another option is the <span class="citation">Northrop and Coleman
(2014)</span> penultimate test, which considers a sequence of threshold
and tests whether a single shape fits the data against the alternative
where the shape parameter differs at each candidate threshold following
a step function. The <code>NC.diag</code> function plots the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
path against the candidate thresholds; the top axis also displays the
number of threshold exceedances. The extended generalized Pareto
distribution can also be used to produce threshold stability plot with
95% confidence intervals. The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa=1</annotation></semantics></math>
if the model is generalized Pareto. Although there are three potential
families, the family <code>egp2</code> seems prefered for most
settings.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fNCdiag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thselect.ncpgp.html">thselect.ncpgp</a></span><span class="op">(</span>xdat <span class="op">=</span> <span class="va">nzrain</span>, thresh <span class="op">=</span> <span class="va">thcan</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="02-threshold_files/figure-html/fig-NCdiag-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tstab.egp.html">tstab.egp</a></span><span class="op">(</span>xdat <span class="op">=</span> <span class="va">nzrain</span>, </span>
<span>          thresh <span class="op">=</span> <span class="va">thcan</span>, </span>
<span>          model <span class="op">=</span> <span class="st">"pt-power"</span><span class="op">)</span></span></code></pre></div>
<p><img src="02-threshold_files/figure-html/tstagegp-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>What do you notice on the parameter stability plots?</p>
<p>We can plot simultaneous parameter stability plots for the shape, as
well as the white-noise sequence. The <code>W.diag</code> function,
which implements the tests of <span class="citation">Wadsworth
(2016)</span>, returns the white noise process and calculates by
simulation the null distribution, selecting the lowest threshold at
which the hypothesis of changepoint is not rejected for all higher
thresholds. For the Maiquetia rainfall, a threshold around 15.15mm is
returned.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fWdiag</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/thselect.wseq.html">thselect.wseq</a></span><span class="op">(</span></span>
<span>    xdat <span class="op">=</span> <span class="va">nzrain</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"nhpp"</span>,</span>
<span>    thresh <span class="op">=</span> <span class="va">thcan</span>,</span>
<span>    plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="02-threshold_files/figure-html/Wdiag-1.png" width="90%" style="display: block; margin: auto;"><img src="02-threshold_files/figure-html/Wdiag-2.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="exercice">Exercice<a class="anchor" aria-label="anchor" href="#exercice"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Try using the threshold diagnostic tests on the <code>nidd</code>
river flow data. Which threshold would you choose based on the
conclusions of the test? Repeat the analysis on your favorite
dataset.</li>
<li>Compare the inference obtained by using the different threshold (by
comparing, for example, return levels or quantiles of a distribution of
interest). Are your results sensitive to the choice of threshold?</li>
</ol>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Coles:2001" class="csl-entry">
Coles, Stuart. 2001. <em>An <span>I</span>ntroduction to
<span>S</span>tatistical <span>M</span>odeling of <span>E</span>xtreme
<span>V</span>alues</em>. London: Springer‚ÄìVerlag.
</div>
<div id="ref-Davison:1990" class="csl-entry">
Davison, A. C., and R. L. Smith. 1990. <span>‚ÄúModels for Exceedances
over High Thresholds (with Discussion).‚Äù</span> <em>Journal of the Royal
Statistical Society. Series B. (Methodological)</em> 52 (3): 393‚Äì442. <a href="http://www.jstor.org/stable/2345667" class="external-link">http://www.jstor.org/stable/2345667</a>.
</div>
<div id="ref-Dupuis:1999" class="csl-entry">
Dupuis, D. J. 1999. <span>‚ÄúExceedances over High Thresholds: A Guide to
Threshold Selection.‚Äù</span> <em>Extremes</em> 1 (3): 251‚Äì61. <a href="https://doi.org/10.1023/A:1009914915709" class="external-link">https://doi.org/10.1023/A:1009914915709</a>.
</div>
<div id="ref-Northrop:2014" class="csl-entry">
Northrop, Paul J., and Claire L. Coleman. 2014. <span>‚ÄúImproved
Threshold Diagnostic Plots for Extreme Value Analyses.‚Äù</span>
<em>Extremes</em> 17 (2): 289‚Äì303. <a href="https://doi.org/10.1007/s10687-014-0183-z" class="external-link">https://doi.org/10.1007/s10687-014-0183-z</a>.
</div>
<div id="ref-Papastathopoulos:2013" class="csl-entry">
Papastathopoulos, Ioannis, and Jonathan A. Tawn. 2013. <span>‚ÄúExtended
Generalised <span>P</span>areto Models for Tail Estimation.‚Äù</span>
<em>Journal of Statistical Planning and Inference</em> 143 (1): 131‚Äì43.
<a href="https://doi.org/10.1016/j.jspi.2012.07.001" class="external-link">https://doi.org/10.1016/j.jspi.2012.07.001</a>.
</div>
<div id="ref-Scarrott:2012" class="csl-entry">
Scarrott, Carl, and Anna MacDonald. 2012. <span>‚ÄúA Review of
Extreme-Value Threshold Estimation and Uncertainty
Quantification.‚Äù</span> <em>REVSTAT ‚Äì Statistical Journal</em> 10 (1):
33‚Äì60. <a href="https://www.ine.pt/revstat/pdf/rs120102.pdf" class="external-link">https://www.ine.pt/revstat/pdf/rs120102.pdf</a>.
</div>
<div id="ref-Smith:1987" class="csl-entry">
Smith, Richard L. 1987. <span>‚ÄúApproximations in Extreme Value
Theory.‚Äù</span> Edited by University of North Carolina Chapel Hill
Center for Stochastic Processes.
</div>
<div id="ref-Wadsworth:2016" class="csl-entry">
Wadsworth, J. L. 2016. <span>‚ÄúExploiting Structure of Maximum Likelihood
Estimators for Extreme Value Threshold Selection.‚Äù</span>
<em>Technometrics</em> 58 (1): 116‚Äì26. <a href="https://doi.org/10.1080/00401706.2014.998345" class="external-link">https://doi.org/10.1080/00401706.2014.998345</a>.
</div>
<div id="ref-Wadsworth:2012" class="csl-entry">
Wadsworth, J. L., and J. A. Tawn. 2012. <span>‚ÄúLikelihood-Based
Procedures for Threshold Diagnostics and Uncertainty in Extreme Value
Modelling.‚Äù</span> <em>Journal of the Royal Statistical Society: Series
B (Statistical Methodology)</em> 74 (3): 543‚Äì67. <a href="https://doi.org/10.1111/j.1467-9868.2011.01017.x" class="external-link">https://doi.org/10.1111/j.1467-9868.2011.01017.x</a>.
</div>
<div id="ref-White:1982" class="csl-entry">
White, Halbert. 1982. <span>‚ÄúMaximum Likelihood Estimation of
Misspecified Models.‚Äù</span> <em>Econometrica</em> 50 (1): 1‚Äì25. <a href="http://www.jstor.org/stable/1912526" class="external-link">http://www.jstor.org/stable/1912526</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop, Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
