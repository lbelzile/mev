<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulation of multivariate extreme value distributions and processes • mev</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of multivariate extreme value distributions and processes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.10007</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a></li>
    <li><a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection</a></li>
    <li><a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a></li>
    <li><a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a></li>
    <li><a class="dropdown-item" href="../articles/mev-vignette.html">Exact unconditional sampling from max-stable random vectors</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation of multivariate extreme value distributions and processes</h1>
                        <h4 data-toc-skip class="author">Léo
Belzile</h4>
            
            <h4 data-toc-skip class="date">2025-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/vignettes/04-simulation.Rmd" class="external-link"><code>vignettes/04-simulation.Rmd</code></a></small>
      <div class="d-none name"><code>04-simulation.Rmd</code></div>
    </div>

    
    
<p>This vignette discusses unconditional simulation of extreme value
processes, showcasing the functions provided by <code>mev</code> for
this. A very quick spatial analysis is also performed using weighted
least squares.</p>
<div class="section level2">
<h2 id="theory-and-models">Theory and models<a class="anchor" aria-label="anchor" href="#theory-and-models"></a>
</h2>
<div class="section level3">
<h3 id="max-stable-processes">Max-stable processes<a class="anchor" aria-label="anchor" href="#max-stable-processes"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒮</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation></semantics></math>
be a compact subset of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℝ</mi><mi>d</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^d</annotation></semantics></math>.
The de Haan spectral representation <span class="citation">(Haan
1984)</span> of simple max-stable processes is <span class="citation">(Schlather and Tawn 2003)</span>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>max</mo><mrow><mi>i</mi><mo>∈</mo><mi>ℕ</mi></mrow></munder><msub><mi>ζ</mi><mi>i</mi></msub><msub><mi>W</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="2.0em"></mspace><mi>𝐬</mi><mo>∈</mo><mi>𝒮</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">Z(\boldsymbol{s}) = \max_{i \in \mathbb{N}} \zeta_i W_i(\boldsymbol{s}), \qquad \boldsymbol{s} \in \mathcal{S},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐖</mi><annotation encoding="application/x-tex">\boldsymbol{W}</annotation></semantics></math>
is a stochastic process satisfying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mo stretchy="false" form="prefix">{</mo><mi>W</mi><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo></msub><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathrm{E}\{W(\boldsymbol{s})_{+}\}=1</annotation></semantics></math>
for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐬</mi><mo>∈</mo><mi>𝒮</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{s} \in \mathcal{S}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>ζ</mi><mi>i</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mo>∈</mo><mi>ℕ</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\{\zeta_i\}_{i \in \mathbb{N}}</annotation></semantics></math>
is a Poisson point process with intensity function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ζ</mi><mrow><mi>−</mi><mn>2</mn></mrow></msup><mi mathvariant="normal">d</mi><mi>ζ</mi></mrow><annotation encoding="application/x-tex">\zeta^{-2} \mathrm{d} \zeta</annotation></semantics></math>.
Max-stable processes arise as the pointwise maximum of an infinite
collection of random functions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>φ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>ζ</mi><mi>i</mi></msub><msub><mi>𝐖</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\varphi_i = \zeta_i \boldsymbol{W}_i</annotation></semantics></math>.</p>
<p>The distribution function of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>-dimensional
max-stable vector can be defined in terms of a measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Λ</mi><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math>,
termed exponent measure, defined on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ℝ</mi><mi>D</mi></msup><mo>\</mo><mo stretchy="false" form="prefix">{</mo><msub><mn>𝟎</mn><mi>D</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathbb{R}^D \setminus\{\boldsymbol{0}_D\}</annotation></semantics></math>
viz.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐙</mi><mo>≤</mo><mi>𝐳</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mo stretchy="false" form="prefix">{</mo><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mi mathvariant="bold">∞</mi><mo>,</mo><mi>𝐳</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi mathvariant="normal">c</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mspace width="1.0em"></mspace><mi>𝐳</mi><mo>&gt;</mo><msub><mn>𝟎</mn><mi>D</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\Pr(\boldsymbol{Z} \leq \boldsymbol{z}) = \exp\{\Lambda([-\boldsymbol{\infty}, \boldsymbol{z}]^\mathrm{c})\}, \quad \boldsymbol{z} &gt; \boldsymbol{0}_D.</annotation></semantics></math>
It follows from max-stability that the exponent measure is homogeneous
of order
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="r-pareto-processes-and-generalizations">R-Pareto processes and generalizations<a class="anchor" aria-label="anchor" href="#r-pareto-processes-and-generalizations"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℱ</mi><mo>+</mo></msup><annotation encoding="application/x-tex">\mathcal{F}^+</annotation></semantics></math>
denote the set of continuous non-negative non-null functions. A risk
functional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℛ</mi><mo>:</mo><msup><mi>ℱ</mi><mo>+</mo></msup><mo>→</mo><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mi>∞</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{R}:\mathcal{F}^+ \to [0, \infty)</annotation></semantics></math>
is a continuous functional which is homogeneous of order
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>,
i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>t</mi><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{R}(tf) = t\mathcal{R}(f)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>∈</mo><msup><mi>ℱ</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">f \in \mathcal{F}^+</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t&gt;0</annotation></semantics></math>.
Examples include maxima,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>max</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐬</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{R}(f) = \max_{j=1}^D f(\boldsymbol{s}_j)</annotation></semantics></math>,
minima,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>min</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐬</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{R}(f) = \min_{j=1}^D f(\boldsymbol{s}_j)</annotation></semantics></math>,
sums
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐬</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{R}(f) = \sum_{j=1}^D f(\boldsymbol{s}_j)</annotation></semantics></math>
and projections
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐬</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{R}(f) = X(\boldsymbol{s}_j)</annotation></semantics></math>.
A
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
process admits the stochastic representation [<span class="citation">Ferreira and de Haan (2014)</span>]<span class="citation">(Dombry and Ribatet 2015)</span>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>𝖷</mi><mo>=</mo><mi>P</mi><mfrac><mi>𝖲</mi><mrow><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  \mathsf{X} = P \frac{\mathsf{S}}{\mathcal{R}(\mathsf{S})},
 \end{align}</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
a unit Pareto random variable with survival function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo>&gt;</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>x</mi><mrow><mi>−</mi><mi>α</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\Pr(P&gt;x) = x^{-\alpha}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x \geq 1</annotation></semantics></math>
and a stochastic process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝖲</mi><annotation encoding="application/x-tex">\mathsf{S}</annotation></semantics></math>,
independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>,
with sample paths in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝕊</mi><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi></mrow></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>f</mi><mo>∈</mo><msup><mi>ℱ</mi><mo>+</mo></msup><mo>\</mo><msub><mi>𝒞</mi><mi>ℛ</mi></msub><mo>:</mo><mo stretchy="false" form="postfix">∥</mo><mi>f</mi><msub><mo stretchy="false" form="postfix">∥</mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathbb{S}_{\mathrm{ang}} = \{f \in \mathcal{F}^+ \setminus \mathcal{C}_{\mathcal{R}}: \|f\|_{\mathrm{ang}} = 1\}</annotation></semantics></math>
and where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝒞</mi><mi>ℛ</mi></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>g</mi><mo>∈</mo><msup><mi>ℱ</mi><mo>+</mo></msup><mo>:</mo><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{C}_{\mathcal{R}} = \{g \in \mathcal{F}^+: \mathcal{R}(x)=0\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">∥</mo><mo>⋅</mo><msub><mo stretchy="false" form="postfix">∥</mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\|\cdot\|_{\mathrm{ang}}</annotation></semantics></math>
is a norm.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
processes come about when looking at the limit distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-exceedances,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>f</mi><mo>:</mo><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mi>u</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{f: \mathcal{R}(f) &gt;u\}</annotation></semantics></math>
for a large threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>,
assuming unit Frechet margins. This can be achieved in practice by
standardizing the margins, but with the drawback that the exceedances
are defined on the transformed scale.</p>
<p><span class="citation">de Fondeville (2018)</span> lifts this
assumption and define generalized
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
processes, allowing for different location and scale marginal parameters
(but with a common shape parameter). The risk region in which extreme
observations lie is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝒜</mi><mi>u</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>f</mi><mo>∈</mo><msup><mi>ℱ</mi><mo>+</mo></msup><mo>\</mo><msub><mi>𝒞</mi><mi>ℛ</mi></msub><mo>:</mo><mi>ℛ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛕</mi><mfrac><mrow><msup><mi>f</mi><mi>ξ</mi></msup><mo>−</mo><mn>1</mn></mrow><mi>ξ</mi></mfrac><mo>+</mo><mi>𝛈</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><mi>u</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\mathcal{A}_u= 
\left\{f \in \mathcal{F}^+ \setminus \mathcal{C}_{\mathcal{R}}: \mathcal{R} \left( \boldsymbol{\tau} \frac{f^\xi-1}{\xi}+\boldsymbol{\eta}\right) \geq u\right\},
\end{align*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛈</mi><annotation encoding="application/x-tex">\boldsymbol{\eta}</annotation></semantics></math>
is a location function and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛕</mi><annotation encoding="application/x-tex">\boldsymbol{\tau}</annotation></semantics></math>
is a scale function. The probability measure of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>𝖹</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\mathsf{Z}^*</annotation></semantics></math>
over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝒜</mi><mi>u</mi></msub><annotation encoding="application/x-tex">\mathcal{A}_u</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>Λ</mi><mo stretchy="false" form="prefix">{</mo><msub><mi>𝒜</mi><mi>u</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Lambda(\cdot)/\Lambda\{\mathcal{A}_u\}</annotation></semantics></math>.
The stochastic representation of the generalized
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
vector is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><mi>X</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>ξ</mi></msup><mo>−</mo><mn>1</mn></mrow><mi>ξ</mi></mfrac><mo>+</mo><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    Z(\boldsymbol{s}) = \tau(\boldsymbol{s}) \frac{X(\boldsymbol{s})^{\xi}-1}{\xi}+ \eta(\boldsymbol{s}), 
\end{align}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X(\boldsymbol{s})</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
process. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>max</mo><annotation encoding="application/x-tex">\max</annotation></semantics></math>,
the finite-dimensional distributions are multivariate generalized Pareto
<span class="citation">(Rootzén, Segers, and Wadsworth 2018)</span>.</p>
</div>
<div class="section level2">
<h2 id="simulation-algorithms">Simulation algorithms<a class="anchor" aria-label="anchor" href="#simulation-algorithms"></a>
</h2>
<p>The original goal of the <code>mev</code> package was to implement
the algorithm of <span class="citation">Dombry, Engelke, and Oesting
(2016)</span>, in order to perform exact simulation from max-stable
vectors by sampling each extremal function in turn. Since then, other
algorithms for simulating from standard
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
processes and generalized
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
processes have been added to the package. These are based on
accept-reject method or composition sampling and can be slow in high
dimensions. Note that packages such as <code>RandomFields</code> and
<code>SpatialExtremes</code> are tailored for spatial processes and
include more efficient algorithms to sample the (log-)Gaussian
components appearing in the Brown–Resnick and extremal Student models,
which makes them typically faster. The vignette provides details about
the parametrization of the models implemented in <code>mev</code>.</p>
<p>The various functions of interest for simulation include</p>
<ul>
<li>
<code>rmev</code>, which is the workshorse for simulating max-stable
random vectors;</li>
<li>
<code>rmevspec</code> returns samples from the angular distribution
defined with respect to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mn>1</mn></msub><annotation encoding="application/x-tex">l_1</annotation></semantics></math>
norm;</li>
<li>
<code>rparp</code> for simulating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
processes through accept-reject;</li>
<li>
<code>rparpcs</code> for simulating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
processes using composition sampling, e.g. <span class="citation">Ho and
Dombry (2019)</span>
</li>
<li>
<code>rgparp</code> for simulating generalized
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
processes using accept-reject.</li>
</ul>
<p>This approach is only available for Brown–Resnick and extremal
Student processes and is more computationally intensive since it
requires computing numerically mixture weights. However, these need only
be computed once and this approach is more efficient for simlating large
samples, particularly in cases where the acceptance rate is very low
(notably if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐗</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>min</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msub><mi>X</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">R(\boldsymbol{X})=\min_{j=1}^DX_j</annotation></semantics></math>).</p>
<p>Let’s start by simulating from a simple max-stable random vector from
the negative logistic model. The margins are unit Frechet, and we can
verify this by pooling the observations and fitting a generalized
extreme value distribution to the sample. The parameter estimates are
correct, and a probability-probability plot shows that the .</p>
<p>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐙</mi><annotation encoding="application/x-tex">\boldsymbol{Z}</annotation></semantics></math>
is a max-stable vector of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
with standard Gumbel margins, with distribution function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐳</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mi>V</mi><mo stretchy="false" form="prefix">{</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐳</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">G(\boldsymbol{z}) = \exp[-V\{\exp(\boldsymbol{z})\}]</annotation></semantics></math>,
then for any subset of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>⊆</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>D</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">J \subseteq\{1, \ldots, D\}</annotation></semantics></math>,
the variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>J</mi></msub><mo>=</mo><msub><mo>max</mo><mrow><mi>j</mi><mo>∈</mo><mi>J</mi></mrow></msub><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐬</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z_J=\max_{j \in J} Z(\boldsymbol{s}_j)</annotation></semantics></math>
has distribution function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mo stretchy="false" form="prefix">{</mo><mi>−</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>−</mo><msub><mi>μ</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">H_J(z) = \exp\{-\exp(z-\mu_{J})\}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>J</mi></msub><mo>=</mo><mo>log</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>V</mi><mi>J</mi></msub><msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟏</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mu_J=\log\{V_J(\boldsymbol{1})_{|J|})\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>μ</mi><mi>J</mi></msub><mo>≤</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">0 \leq \mu_J \leq \log(|J|)</annotation></semantics></math>.
This follows from the homogeneity of the exponent measure. <span class="citation">Gabda et al. (2012)</span> propose a
probability-probability plot based on fitting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>J</mi></msub><annotation encoding="application/x-tex">\mu_J</annotation></semantics></math>
through maximum likelihood with the parameter constraints for each set
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|J|</annotation></semantics></math>
stations. The data are obtained by pooling replications of the
max-stable field and selecting all subsets of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|J|</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>D</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\binom{D}{|J|}</annotation></semantics></math>
is small, or else a limited number of stations among those that display
the higher dependence so as to maximize the power of the test
(independence being a special case of max-stability). Uncertainty
quantification is performed using a nonparametric bootstrap. The
function <code>test.maxstab</code> implements this for the special case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">J=D</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lbelzile.github.io/mev/" class="external-link">mev</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmev.html">rmev</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  param <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"neglog"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fgev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.gev.html">fit.gev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">fgev</span><span class="op">$</span><span class="va">estimate</span></span></code></pre></div>
<pre><code><span><span class="co">##       loc     scale     shape </span></span>
<span><span class="co">## 0.9954939 0.9919429 0.9867670</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Test of max-stability</span></span>
<span><span class="fu"><a href="../reference/test.maxstab.html">test.maxstab</a></span><span class="op">(</span>xdat <span class="op">=</span> <span class="va">samp</span><span class="op">)</span></span>
<span><span class="co"># Probability-probability plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fgev</span>, which <span class="op">=</span> <span class="st">"pp"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="04-simulation_files/figure-html/maxstabtest-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The likelihood of max-stable processes is untractable, so inference
is typically performed using composite likelihood. The package
<code>evd</code> includes routines for doing this in the bivariate
setting (see <code>fbvpot</code>).</p>
<p>Consider a collection of independent and identically distributed
vectors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\boldsymbol{X}</annotation></semantics></math>
with continuous marginal distributions that are in the max-domain of
attraction of a max-stable distribution with limit measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Λ</mi><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math>.
One can transform the observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐗</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{X}_i</annotation></semantics></math>
into pseudo-uniform samples using the empirical distribution function or
else the semi-parametric estimator,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mover><mi>F</mi><mo accent="true">̌</mo></mover><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi mathvariant="normal">I</mi><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mo>:</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≤</mo><mi>x</mi><mo stretchy="false" form="postfix">}</mo><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>x</mi><mo>≤</mo><msub><mi>u</mi><mi>j</mi></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>−</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><msub><mover><mi>F</mi><mo accent="true">̃</mo></mover><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><msubsup><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo>+</mo><mover><mi>ξ</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>x</mi><mo>−</mo><msub><mi>u</mi><mi>j</mi></msub></mrow><msub><mover><mi>τ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>+</mo><mrow><mi>−</mi><mn>1</mn><mi>/</mi><msub><mover><mi>ξ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub></mrow></msubsup><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>x</mi><mo>&gt;</mo><msub><mi>u</mi><mi>j</mi></msub><mi>.</mi></mtd></mtr></mtable></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
 \check{F}_j(x) =
\begin{cases}
\mathrm{I}\{i: y_{ij} \leq x\}/(n+1), &amp;  x \leq u_j,\\
1-\{1-\tilde{F}_j(u_j)\}\left\{1+\hat{\xi}\left(\frac{x-u_j}{\hat{\tau}_j}\right)\right\}^{-1/\hat{\xi}_j}_{+}, &amp; x &gt;u_j.
\end{cases}
\end{align}</annotation></semantics></math> (see <code>spunif</code>).
We can back-transform the pseudo-uniform samples
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>F</mi><mo accent="true">̌</mo></mover><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u_{ij} = \check{F}_j(y_{ij})</annotation></semantics></math>
to unit Pareto using the quantile transform,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi mathvariant="normal">p</mi></msubsup><mo>=</mo><mn>1</mn><mi>/</mi><mn>1</mn><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>u</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z_{ij}^{\mathrm{p}} = 1/1-(u_{ij})</annotation></semantics></math>.
If we map the random vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>𝐙</mi><mi mathvariant="normal">p</mi></msup><annotation encoding="application/x-tex">\boldsymbol{Z}^{\mathrm{p}}</annotation></semantics></math>
to pseudo-polar coordinates,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>𝐙</mi><mi mathvariant="normal">p</mi></msup><mo>↦</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>R</mi><mo>,</mo><mi>𝛀</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{Z}^{\mathrm{p}} \mapsto (R, \boldsymbol{\Omega})</annotation></semantics></math>
from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ℝ</mi><mo>+</mo><mi>D</mi></msubsup><mo>→</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>∞</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><msub><mi>𝕊</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbb{R}^D_{+} \to (0, \infty) \times \mathbb{S}_1</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝕊</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>𝛚</mi><mo>∈</mo><msubsup><mi>ℝ</mi><mo>+</mo><mi>D</mi></msubsup><mo>:</mo><mo stretchy="false" form="postfix">∥</mo><mi>𝛚</mi><msub><mo stretchy="false" form="postfix">∥</mo><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathbb{S}_1=\{ \boldsymbol{\omega} \in \mathbb{R}^D_{+}: \|\boldsymbol{\omega}\|_1=1\}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>ℓ</mo><mn>1</mn></msub><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math>-simplex.
The measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Λ</mi><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math>
factorizes as a product measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi mathvariant="normal">d</mi><mi>𝐳</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>D</mi><msup><mi>ζ</mi><mrow><mi>−</mi><mn>2</mn></mrow></msup><mi mathvariant="normal">d</mi><mi>ζ</mi><msub><mi>ρ</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi mathvariant="normal">d</mi><mi>𝛚</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Lambda(\mathrm{d} \boldsymbol{z}) = D \zeta^{-2}\mathrm{d} \zeta \rho_1(\mathrm{d} \boldsymbol{\omega})</annotation></semantics></math>
with angular measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\rho_1</annotation></semantics></math>,
a probability measure satisfying the moment constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><msub><mo>∫</mo><msub><mi>𝕊</mi><mn>1</mn></msub></msub><msub><mi>ω</mi><mi>j</mi></msub><msub><mi>ρ</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi mathvariant="normal">d</mi><mi>𝛚</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">D\int_{\mathbb{S}_1} \omega_j \rho_1(\mathrm{d} \boldsymbol{\omega})=1</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">j=1, \ldots, D</annotation></semantics></math>;
this moment constraint holds for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\rho_1</annotation></semantics></math>,
whereas it will be measure dependent if the radial measure is not
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">∥</mo><mo>⋅</mo><msub><mo stretchy="false" form="postfix">∥</mo><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\|\cdot \|_1</annotation></semantics></math><span class="citation">(Einmahl and Segers 2009)</span>. We can thus
create an approximate sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛚</mi><annotation encoding="application/x-tex">\boldsymbol{\omega}</annotation></semantics></math>
from the angular measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\rho_1</annotation></semantics></math>
and estimate its distribution non-parametrically as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>H</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mi mathvariant="normal">I</mi><mo stretchy="false" form="prefix">{</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>≤</mo><mi>w</mi><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">\hat{H}(w) = \sum_{i=1}^N \hat{p}_i\mathrm{I}\{\omega_i \leq w\},</annotation></semantics></math>
where the weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><annotation encoding="application/x-tex">\hat{p}_i</annotation></semantics></math>
are obtained as the solution of either the empirical or Euclidean
likelihood problems with a mean constraint <span class="citation">Einmahl and Segers (2009)</span>. Since the resulting
spectral distribution is discrete (which is problematic in simulations),
<span class="citation">Carvalho et al. (2013)</span> suggest fitting a
Dirichlet kernel to observations, with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><msub><mi>𝐰</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nu \boldsymbol{w}_i (i=1, \ldots, D)</annotation></semantics></math>
subject to the constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">∥</mo><mi>ν</mi><msub><mi>𝐰</mi><mi>i</mi></msub><msub><mo stretchy="false" form="postfix">∥</mo><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\|\nu\boldsymbol{w}_{i}\|_1=1</annotation></semantics></math>.
The’bandwidth’ tuning parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
is chosen via cross-validation. The function <code>angmeasdir</code>
fits Euclidean likelihood and returns a list with the weights vector
<code>wts</code>, the cross-validation parameter <code>nu</code> and a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">n \times D</annotation></semantics></math>
matrix of parameters for the Dirichlet distribution.</p>
<p>Alternatively, we can estimate the limiting spectral measure from the
pseudo-observations enforcing the mean constraint using empirical
likelihood, as proposed by <span class="citation">Einmahl and Segers
(2009)</span>. The function <code>angmeas</code> computes the weights
associated to each observations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samp</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/rmev.html">rmev</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    d <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">2.9</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"sdir"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="../reference/taildep.html">taildep</a></span><span class="op">(</span><span class="va">samp</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eta <span class="op">=</span> <span class="st">"betacop"</span>, chi <span class="op">=</span> <span class="st">"betacop"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="04-simulation_files/figure-html/angdensplot-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the probability weights and compute the column mean</span></span>
<span><span class="va">nparangmeas</span> <span class="op">&lt;-</span> <span class="fu">mev</span><span class="fu">::</span><span class="fu"><a href="../reference/angmeas.html">angmeas</a></span><span class="op">(</span><span class="va">samp</span>, th <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nparangmeas</span><span class="op">$</span><span class="va">wts</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"weights"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"observation index"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nparangmeas</span><span class="op">$</span><span class="va">ang</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="04-simulation_files/figure-html/plotweights-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">nparangmeas</span><span class="op">$</span><span class="va">wts</span> <span class="op">*</span> <span class="va">nparangmeas</span><span class="op">$</span><span class="va">ang</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3333333 0.3333333</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dirangmeas</span> <span class="op">&lt;-</span> <span class="fu">mev</span><span class="fu">::</span><span class="fu"><a href="../reference/angmeasdir.html">angmeasdir</a></span><span class="op">(</span><span class="va">samp</span>, th <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extremal-coefficient">Extremal coefficient<a class="anchor" aria-label="anchor" href="#extremal-coefficient"></a>
</h2>
<p>As in <code>SpatialExtremes</code>, we can use the nonparametric
estimates of the extremal coefficient as goodness-of-fit diagnostic. The
following code samples data</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coord</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">di</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">coord</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/rmev.html">rmev</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    d <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    param <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">di</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    model <span class="op">=</span> <span class="st">'xstud'</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extcoef.html">extcoef</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, coord <span class="op">=</span> <span class="va">coord</span><span class="op">)</span></span></code></pre></div>
<p><img src="04-simulation_files/figure-html/extcoef-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extremal Student extremal coefficient function</span></span>
<span><span class="va">XT.extcoeffun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">h</span>, <span class="va">nu</span>, <span class="va">corrfun</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.function.html" class="external-link">is.function</a></span><span class="op">(</span><span class="va">corrfun</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">'Invalid function `corrfun`.'</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">rhoh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">corrfun</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">h</span>, extcoef <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">nu</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rhoh</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">rhoh</span><span class="op">)</span><span class="op">)</span>, <span class="va">nu</span> <span class="op">+</span></span>
<span>                                  <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#This time, only one graph with theoretical extremal coef</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">res</span><span class="op">$</span><span class="va">dist</span>,</span>
<span>  <span class="va">res</span><span class="op">$</span><span class="va">extcoef</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"extremal coefficient"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"distance"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">extcoefxt</span> <span class="op">&lt;-</span> <span class="fu">XT.extcoeffun</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  corrfun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">extcoefxt</span><span class="op">[</span>, <span class="st">'h'</span><span class="op">]</span>,</span>
<span>      <span class="va">extcoefxt</span><span class="op">[</span>, <span class="st">'extcoef'</span><span class="op">]</span>,</span>
<span>      type <span class="op">=</span> <span class="st">'l'</span>,</span>
<span>      col <span class="op">=</span> <span class="st">'blue'</span>,</span>
<span>      lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="04-simulation_files/figure-html/extcoef-2.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="generalized-r-pareto-processes-for-functional-threshold-exceedances">Generalized R-Pareto processes for functional threshold
exceedances<a class="anchor" aria-label="anchor" href="#generalized-r-pareto-processes-for-functional-threshold-exceedances"></a>
</h2>
<p>We simulate a spatial generalized
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
process.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">650</span>, <span class="fl">720</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">215</span>, <span class="fl">290</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co"># Create a grid</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span></span>
<span><span class="va">coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="va">dianiso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span><span class="va">coord</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">sgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">grid</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Specify marginal parameters `loc` and `scale` over grid</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fl">26</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.16</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">9</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.04</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="co"># Parameter matrix of Huesler--Reiss</span></span>
<span><span class="co"># associated to power variogram</span></span>
<span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">dianiso</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span> <span class="op">^</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span></span>
<span><span class="co"># Simulate generalized max-Pareto field above u=50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">345</span><span class="op">)</span></span>
<span><span class="va">simu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rgparp.html">rgparp</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  riskf <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">tau</span>,</span>
<span>  loc <span class="op">=</span> <span class="va">eta</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">Lambda</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"hr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># The same, but conditional on an exceedance at a site</span></span>
<span><span class="va">simu2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rgparp.html">rgparp</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  riskf <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>  siteindex <span class="op">=</span> <span class="fl">1225</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">tau</span>,</span>
<span>  loc <span class="op">=</span> <span class="va">eta</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">Lambda</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"hr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#Plot the generalized max-Pareto field</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">fields</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/quilt.plot.html" class="external-link">quilt.plot</a></span><span class="op">(</span><span class="va">grid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">grid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">simu1</span>, nx <span class="op">=</span> <span class="fl">50</span>, ny <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu">SpatialExtremes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExtremes/man/swiss.html" class="external-link">swiss</a></span><span class="op">(</span>add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">fields</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/quilt.plot.html" class="external-link">quilt.plot</a></span><span class="op">(</span><span class="va">grid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">grid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">simu2</span>, nx <span class="op">=</span> <span class="fl">50</span>, ny <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu">SpatialExtremes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExtremes/man/swiss.html" class="external-link">swiss</a></span><span class="op">(</span>add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="04-simulation_files/figure-html/simuRgpareto-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Value at conditioning coordinate should be greater than 50</span></span>
<span><span class="va">simu2</span><span class="op">[</span><span class="fl">1225</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 84.81661</span></span></code></pre>
<p>The code snippet below fits a Brown–Resnick model with power
variogram to simulated data from the same model (based on more than one
replicate). The parameters are estimated by minimizing the squared
distance between empirical cloud of pairwise conditional probability of
exceedance and the theoretical one. We include geometric anisotropy in
the analysis.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">650</span>, <span class="fl">720</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">215</span>, <span class="fl">290</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># Create a grid</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span></span>
<span><span class="va">coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="va">dianiso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span><span class="va">coord</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">sgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">grid</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Specify marginal parameters `loc` and `scale` over grid</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fl">26</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.16</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">9</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.04</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="co"># Parameter matrix of Huesler--Reiss</span></span>
<span><span class="co"># associated to power variogram</span></span>
<span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">dianiso</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span> <span class="op">^</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span></span>
<span><span class="co"># Simulate generalized max-Pareto field above u=50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">345</span><span class="op">)</span></span>
<span><span class="va">simu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rgparp.html">rgparp</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  riskf <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">tau</span>,</span>
<span>  loc <span class="op">=</span> <span class="va">eta</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">Lambda</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"hr"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">extdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extremo.html">extremo</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">simu1</span>,</span>
<span>  margp <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  coord <span class="op">=</span> <span class="va">coord</span>,</span>
<span>  scale <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="04-simulation_files/figure-html/fitvariocloud-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Constrained optimization</span></span>
<span><span class="co"># Minimize distance between extremal coefficient from fitted variogram</span></span>
<span><span class="va">mindistpvario</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>, <span class="va">emp</span>, <span class="va">coord</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">alpha</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">alpha</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1e10</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">scale</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">scale</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1e10</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">a</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1e10</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1e10</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">semivariomat</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/power.vario.html">power.vario</a></span><span class="op">(</span><span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span><span class="va">coord</span>, <span class="va">a</span>, <span class="va">rho</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, scale <span class="op">=</span> <span class="va">scale</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">semivariomat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">semivariomat</span><span class="op">)</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">emp</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># constrained optimization for the parameters</span></span>
<span><span class="va">hin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.99</span> <span class="op">-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    <span class="op">-</span><span class="fl">1e-5</span> <span class="op">+</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    <span class="op">-</span><span class="fl">1e-5</span> <span class="op">+</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>    <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    <span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu">alabama</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/alabama/man/auglag.html" class="external-link">auglag</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">30</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  hin <span class="op">=</span> <span class="va">hin</span>,</span>
<span>  control.optim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parscale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">30</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">mindistpvario</span><span class="op">(</span><span class="va">par</span>, emp <span class="op">=</span> <span class="va">extdat</span><span class="op">[</span>, <span class="st">'prob'</span><span class="op">]</span>, coord <span class="op">=</span> <span class="va">coord</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Min(hin):  0.49999 </span></span>
<span><span class="co">## Outer iteration:  1 </span></span>
<span><span class="co">## Min(hin):  0.49999 </span></span>
<span><span class="co">## par:  0.5 30 1.5 0.5 </span></span>
<span><span class="co">## fval =   77.37 </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Outer iteration:  2 </span></span>
<span><span class="co">## Min(hin):  0.3992261 </span></span>
<span><span class="co">## par:  0.668296 74.8862 1.39923 0.556808 </span></span>
<span><span class="co">## fval =   6.52 </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Outer iteration:  3 </span></span>
<span><span class="co">## Min(hin):  0.3992502 </span></span>
<span><span class="co">## par:  0.668285 74.8855 1.39925 0.556807 </span></span>
<span><span class="co">## fval =   6.52 </span></span>
<span><span class="co">## </span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">opt</span><span class="op">$</span><span class="va">kkt1</span>, <span class="va">opt</span><span class="op">$</span><span class="va">kkt2</span><span class="op">)</span></span>
<span><span class="co"># Plotting the extremogram in the deformed space</span></span>
<span><span class="va">distfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span>loc <span class="op">=</span> <span class="va">coord</span>, <span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">distfa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">distfa</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="va">extdat</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  yaxs <span class="op">=</span> <span class="st">"i"</span>,</span>
<span>  xaxs <span class="op">=</span> <span class="st">"i"</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">'l'</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"distance"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"cond. prob. of exceedance"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="op">(</span><span class="va">distvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span>, length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/power.vario.html">power.vario</a></span><span class="op">(</span><span class="va">distvec</span>, alpha <span class="op">=</span> <span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="04-simulation_files/figure-html/fitvariocloud-2.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="exercice">Exercice<a class="anchor" aria-label="anchor" href="#exercice"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Simulate Gaussian random vector (using, e.g., the function
<code>mvrnorm</code> or through the package <code>RandomFields</code>)
with independent observations and vectors with covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><msub><mn>𝟏</mn><mi>D</mi></msub><msubsup><mn>𝟏</mn><mi>D</mi><mi>⊤</mi></msubsup><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mn>𝟏</mn><mi>D</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \boldsymbol{1}_D\boldsymbol{1}_D^\top + (1-\alpha)\mathrm{diag}(\boldsymbol{1}_D)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>0.25</mn><mo>,</mo><mn>0.5</mn><mo>,</mo><mn>0.75</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\alpha \in \{0,0.25,0.5,0.75\}</annotation></semantics></math>.
Use <code>maxstabtest</code> on your simulated data and comment on the
diagnostic plots.</li>
<li>Simulate 100 realizaions from a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℛ</mi><annotation encoding="application/x-tex">\mathcal{R}</annotation></semantics></math>-Pareto
process with risk function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>max</mo><annotation encoding="application/x-tex">\max</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>min</mo><annotation encoding="application/x-tex">\min</annotation></semantics></math>
for the Brown–Resnick model with power variogram function
<code>power.vario</code> with shape <code>alpha = 1</code> and
<code>scale = 2</code> on a grid
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>4</mn><msup><mo stretchy="false" form="postfix">}</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\{1,2,\ldots, 4\}^2</annotation></semantics></math>
using <code>rparp</code> and <code>rparpcs</code>. Benchmark the two
methods: which is fastest and what is the acceptance rate of the
accept-reject?</li>
</ol>
<p>Partial sample code for doing this is given below:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">depmat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/power.vario.html">power.vario</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span><span class="va">grid</span>, scale <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span></span>
<span><span class="co"># This is where composition sampling shines!</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rparpcs.html">rparpcs</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  riskf <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>  Lambda <span class="op">=</span> <span class="va">depmat</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"br"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#rparp is computationally intensive with "min" - only for</span></span>
<span><span class="va">samp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rparp.html">rparp</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  riskf <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">depmat</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"hr"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-deCarvalho:2013" class="csl-entry">
Carvalho, Miguel de, Boris Oumow, Johan Segers, and Michał Warchoł.
2013. <span>“A <span>E</span>uclidean Likelihood Estimator for Bivariate
Tail Dependence.”</span> <em>Communications in Statistics - Theory and
Methods</em> 42 (7): 1176–92. <a href="https://doi.org/10.1080/03610926.2012.709905" class="external-link">https://doi.org/10.1080/03610926.2012.709905</a>.
</div>
<div id="ref-deFondeville:thesis" class="csl-entry">
de Fondeville, Raphaël. 2018. <span>“Functional Peaks-over-Threshold
Analysis for Complex Extreme Events.”</span> PhD thesis, Lausanne: EPFL;
MATH. <a href="https://doi.org/10.5075/epfl-thesis-8927" class="external-link">https://doi.org/10.5075/epfl-thesis-8927</a>.
</div>
<div id="ref-Dombry:2016" class="csl-entry">
Dombry, Clément, Sebastian Engelke, and Marco Oesting. 2016.
<span>“Exact Simulation of Max-Stable Processes.”</span>
<em>Biometrika</em> 103 (2): 303–17. <a href="https://doi.org/10.1093/biomet/asw008" class="external-link">https://doi.org/10.1093/biomet/asw008</a>.
</div>
<div id="ref-Dombry/Ribatet:2015" class="csl-entry">
Dombry, Clément, and Mathieu Ribatet. 2015. <span>“Functional Regular
Variations, <span>P</span>areto Processes and Peaks over
Threshold.”</span> <em>Statistics and Its Interface</em> 8 (1): 9–17. <a href="https://doi.org/10.4310/SII.2015.v8.n1.a2" class="external-link">https://doi.org/10.4310/SII.2015.v8.n1.a2</a>.
</div>
<div id="ref-Einmahl:2009" class="csl-entry">
Einmahl, John H. J., and Johan Segers. 2009. <span>“Maximum Empirical
Likelihood Estimation of the Spectral Measure of an Extreme-Value
Distribution.”</span> <em>Ann. Statist.</em> 37 (5B): 2953–89. <a href="https://doi.org/10.1214/08-AOS677" class="external-link">https://doi.org/10.1214/08-AOS677</a>.
</div>
<div id="ref-Ferreira:2014" class="csl-entry">
Ferreira, Ana, and Laurens de Haan. 2014. <span>“The Generalized
<span>P</span>areto Process; with a View Towards Application and
Simulation.”</span> <em>Bernoulli</em> 20 (4): 1717–37. <a href="https://doi.org/10.3150/13-BEJ538" class="external-link">https://doi.org/10.3150/13-BEJ538</a>.
</div>
<div id="ref-Gabda:2012" class="csl-entry">
Gabda, Darmesah, Ross Towe, Jennifer Wadsworth, and Jonathan Tawn. 2012.
<span>“Discussion of <span>‘<span>S</span>tatistical Modeling of Spatial
Extremes’</span> by <span>A</span>. <span>C</span>.
<span>D</span>avison, <span>S</span>. <span>A</span>.
<span>P</span>adoan and <span>M</span>. <span>R</span>ibatet.”</span>
<em>Statistical Science</em> 27 (2): 189–92. <a href="https://doi.org/10.1214/12-STS376B" class="external-link">https://doi.org/10.1214/12-STS376B</a>.
</div>
<div id="ref-deHaan:1984" class="csl-entry">
Haan, L. de. 1984. <span>“A Spectral Representation for Max-Stable
Processes.”</span> <em>Ann. Probab.</em> 12 (4): 1194–204.<a href="%0A%09%09%0A%09%09http://links.jstor.org/sici?sici=0091-1798(198411)12:4%3C1194:ASRFMP%3E2.0.CO;2-R&amp;origin=MSN%0A%09" class="external-link">http://links.jstor.org/sici?sici=0091-1798(198411)12:4&lt;1194:ASRFMP&gt;2.0.CO;2-R&amp;origin=MSN
</a>.
</div>
<div id="ref-Ho/Dombry:2019" class="csl-entry">
Ho, Zhen Wai Olivier, and Clément Dombry. 2019. <span>“Simple Models for
Multivariate Regular Variation and the
<span>H</span><span>ü</span>sler–<span>R</span>eiss <span>P</span>areto
Distribution.”</span> <em>Journal of Multivariate Analysis</em> 173:
525–50. <a href="https://doi.org/10.1016/j.jmva.2019.04.008" class="external-link">https://doi.org/10.1016/j.jmva.2019.04.008</a>.
</div>
<div id="ref-Rootzen:2017" class="csl-entry">
Rootzén, Holger, Johan Segers, and Jennifer L. Wadsworth. 2018.
<span>“Multivariate Peaks over Thresholds Models.”</span>
<em>Extremes</em> 21 (1): 115–45. <a href="https://doi.org/10.1007/s10687-017-0294-4" class="external-link">https://doi.org/10.1007/s10687-017-0294-4</a>.
</div>
<div id="ref-Schlather:2003" class="csl-entry">
Schlather, Martin, and Jonathan A. Tawn. 2003. <span>“A Dependence
Measure for Multivariate and Spatial Extreme Values: Properties and
Inference.”</span> <em>Biometrika</em> 90 (1): 139–56. <a href="https://doi.org/10.1093/biomet/90.1.139" class="external-link">https://doi.org/10.1093/biomet/90.1.139</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop, Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
