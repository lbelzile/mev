<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mev">
<title>Simulation of multivariate extreme value distributions and processes • mev</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of multivariate extreme value distributions and processes">
<meta property="og:description" content="mev">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13.10000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a>
    <a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection tools</a>
    <a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a>
    <a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulation of multivariate extreme value distributions and processes</h1>
                        <h4 data-toc-skip class="author">Léo
Belzile</h4>
            
            <h4 data-toc-skip class="date">2022-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/vignettes/04-simulation.Rmd" class="external-link"><code>vignettes/04-simulation.Rmd</code></a></small>
      <div class="d-none name"><code>04-simulation.Rmd</code></div>
    </div>

    
    
<p>This vignette discusses unconditional simulation of extreme value
processes, showcasing the functions provided by <code>mev</code> for
this. A very quick spatial analysis is also performed using weighted
least squares.</p>
<div class="section level2">
<h2 id="theory-and-models">Theory and models<a class="anchor" aria-label="anchor" href="#theory-and-models"></a>
</h2>
<div class="section level3">
<h3 id="max-stable-processes">Max-stable processes<a class="anchor" aria-label="anchor" href="#max-stable-processes"></a>
</h3>
<p>Let <span class="math inline">\(\mathcal{S}\)</span> be a compact
subset of <span class="math inline">\(\mathbb{R}^d\)</span>. The de Haan
spectral representation <span class="citation">(Haan 1984)</span> of
simple max-stable processes is <span class="citation">(Schlather and
Tawn 2003)</span> <span class="math display">\[Z(\boldsymbol{s}) =
\max_{i \in \mathbb{N}} \zeta_i W_i(\boldsymbol{s}), \qquad
\boldsymbol{s} \in \mathcal{S},\]</span> where <span class="math inline">\(\boldsymbol{W}\)</span> is a stochastic process
satisfying <span class="math inline">\(\mathrm{E}\{W(\boldsymbol{s})_{+}\}=1\)</span> for
any <span class="math inline">\(\boldsymbol{s} \in \mathcal{S}\)</span>
and <span class="math inline">\(\{\zeta_i\}_{i \in \mathbb{N}}\)</span>
is a Poisson point process with intensity function <span class="math inline">\(\zeta^{-2} \mathrm{d} \zeta\)</span>. Max-stable
processes arise as the pointwise maximum of an infinite collection of
random functions <span class="math inline">\(\varphi_i = \zeta_i
\boldsymbol{W}_i\)</span>.</p>
<p>The distribution function of a <span class="math inline">\(D\)</span>-dimensional max-stable vector can be
defined in terms of a measure <span class="math inline">\(\Lambda\)</span>, termed exponent measure, defined
on <span class="math inline">\(\mathbb{R}^D
\setminus\{\boldsymbol{0}_D\}\)</span> viz. <span class="math display">\[\Pr(\boldsymbol{Z} \leq \boldsymbol{z}) =
\exp\{\Lambda([-\boldsymbol{\infty}, \boldsymbol{z}]^\mathrm{c})\},
\quad \boldsymbol{z} &gt; \boldsymbol{0}_D.\]</span> It follows from
max-stability that the exponent measure is homogeneous of order <span class="math inline">\(-1\)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="r-pareto-processes-and-generalizations">R-Pareto processes and generalizations<a class="anchor" aria-label="anchor" href="#r-pareto-processes-and-generalizations"></a>
</h2>
<p>Let <span class="math inline">\(\mathcal{F}^+\)</span> denote the set
of continuous non-negative non-null functions. A risk functional <span class="math inline">\(\mathcal{R}:\mathcal{F}^+ \to [0, \infty)\)</span>
is a continuous functional which is homogeneous of order <span class="math inline">\(1\)</span>, i.e., <span class="math inline">\(\mathcal{R}(tf) = t\mathcal{R}(f)\)</span> for
<span class="math inline">\(f \in \mathcal{F}^+\)</span> and <span class="math inline">\(t&gt;0\)</span>. Examples include maxima, <span class="math inline">\(\mathcal{R}(f) = \max_{j=1}^D
f(\boldsymbol{s}_j)\)</span>, minima, <span class="math inline">\(\mathcal{R}(f) = \min_{j=1}^D
f(\boldsymbol{s}_j)\)</span>, sums <span class="math inline">\(\mathcal{R}(f) = \sum_{j=1}^D
f(\boldsymbol{s}_j)\)</span> and projections <span class="math inline">\(\mathcal{R}(f) = X(\boldsymbol{s}_j)\)</span>. A
<span class="math inline">\(\mathcal{R}\)</span>-Pareto process admits
the stochastic representation [<span class="citation">Ferreira and de
Haan (2014)</span>]<span class="citation">(Dombry and Ribatet
2015)</span> <span class="math display">\[\begin{align}
  \mathsf{X} = P \frac{\mathsf{S}}{\mathcal{R}(\mathsf{S})},
\end{align}\]</span> for <span class="math inline">\(P\)</span> a unit
Pareto random variable with survival function <span class="math inline">\(\Pr(P&gt;x) = x^{-\alpha}\)</span> for <span class="math inline">\(x \geq 1\)</span> and a stochastic process <span class="math inline">\(\mathsf{S}\)</span>, independent of <span class="math inline">\(P\)</span>, with sample paths in <span class="math inline">\(\mathbb{S}_{\mathrm{ang}} = \{f \in \mathcal{F}^+
\setminus \mathcal{C}_{\mathcal{R}}: \|f\|_{\mathrm{ang}} = 1\}\)</span>
and where <span class="math inline">\(\mathcal{C}_{\mathcal{R}} = \{g
\in \mathcal{F}^+: \mathcal{R}(x)=0\}\)</span> and <span class="math inline">\(\|\cdot\|_{\mathrm{ang}}\)</span> is a norm. <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes come about
when looking at the limit distribution of <span class="math inline">\(\mathcal{R}\)</span>-exceedances, i.e. <span class="math inline">\(\{f: \mathcal{R}(f) &gt;u\}\)</span> for a large
threshold <span class="math inline">\(u\)</span>, assuming unit Frechet
margins. This can be achieved in practice by standardizing the margins,
but with the drawback that the exceedances are defined on the
transformed scale.</p>
<p><span class="citation">de Fondeville (2018)</span> lifts this
assumption and define generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes, allowing
for different location and scale marginal parameters (but with a common
shape parameter). The risk region in which extreme observations lie is
<span class="math display">\[\begin{align*}
\mathcal{A}_u=
\left\{f \in \mathcal{F}^+ \setminus \mathcal{C}_{\mathcal{R}}:
\mathcal{R} \left( \boldsymbol{\tau}
\frac{f^\xi-1}{\xi}+\boldsymbol{\eta}\right) \geq u\right\},
\end{align*}\]</span> where <span class="math inline">\(\boldsymbol{\eta}\)</span> is a location function
and <span class="math inline">\(\boldsymbol{\tau}\)</span> is a scale
function. The probability measure of <span class="math inline">\(\mathsf{Z}^*\)</span> over <span class="math inline">\(\mathcal{A}_u\)</span> is <span class="math inline">\(\Lambda(\cdot)/\Lambda\{\mathcal{A}_u\}\)</span>.
The stochastic representation of the generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto vector is <span class="math display">\[\begin{align}
    Z(\boldsymbol{s}) = \tau(\boldsymbol{s})
\frac{X(\boldsymbol{s})^{\xi}-1}{\xi}+ \eta(\boldsymbol{s}),
\end{align}\]</span> where <span class="math inline">\(X(\boldsymbol{s})\)</span> is a <span class="math inline">\(\mathcal{R}\)</span>-Pareto process. When <span class="math inline">\(\mathcal{R}\)</span> is <span class="math inline">\(\max\)</span>, the finite-dimensional
distributions are multivariate generalized Pareto <span class="citation">(Rootzén, Segers, and Wadsworth 2018)</span>.</p>
</div>
<div class="section level2">
<h2 id="simulation-algorithms">Simulation algorithms<a class="anchor" aria-label="anchor" href="#simulation-algorithms"></a>
</h2>
<p>The original goal of the <code>mev</code> package was to implement
the algorithm of <span class="citation">Dombry, Engelke, and Oesting
(2016)</span>, in order to perform exact simulation from max-stable
vectors by sampling each extremal function in turn. Since then, other
algorithms for simulating from standard <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes and
generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto
processes have been added to the package. These are based on
accept-reject method or composition sampling and can be slow in high
dimensions. Note that packages such as <code>RandomFields</code> and
<code>SpatialExtremes</code> are tailored for spatial processes and
include more efficient algorithms to sample the (log-)Gaussian
components appearing in the Brown–Resnick and extremal Student models,
which makes them typically faster. The vignette provides details about
the parametrization of the models implemented in <code>mev</code>.</p>
<p>The various functions of interest for simulation include</p>
<ul>
<li>
<code>rmev</code>, which is the workshorse for simulating max-stable
random vectors;</li>
<li>
<code>rmevspec</code> returns samples from the angular distribution
defined with respect to the <span class="math inline">\(l_1\)</span>
norm;</li>
<li>
<code>rparp</code> for simulating <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes through
accept-reject;</li>
<li>
<code>rparpcs</code> for simulating <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes using
composition sampling, e.g. <span class="citation">Ho and Dombry
(2019)</span>
</li>
<li>
<code>rgparp</code> for simulating generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes using
accept-reject.</li>
</ul>
<p>This approach is only available for Brown–Resnick and extremal
Student processes and is more computationally intensive since it
requires computing numerically mixture weights. However, these need only
be computed once and this approach is more efficient for simlating large
samples, particularly in cases where the acceptance rate is very low
(notably if <span class="math inline">\(R(\boldsymbol{X})=\min_{j=1}^DX_j\)</span>).</p>
<p>Let’s start by simulating from a simple max-stable random vector from
the negative logistic model. The margins are unit Frechet, and we can
verify this by pooling the observations and fitting a generalized
extreme value distribution to the sample. The parameter estimates are
correct, and a probability-probability plot shows that the .</p>
<p>If <span class="math inline">\(\boldsymbol{Z}\)</span> is a
max-stable vector of size <span class="math inline">\(D\)</span> with
standard Gumbel margins, with distribution function <span class="math inline">\(G(\boldsymbol{z}) =
\exp[-V\{\exp(\boldsymbol{z})\}]\)</span>, then for any subset of size
<span class="math inline">\(J \subseteq\{1, \ldots, D\}\)</span>, the
variable <span class="math inline">\(Z_J=\max_{j \in J}
Z(\boldsymbol{s}_j)\)</span> has distribution function <span class="math inline">\(H_J(z) = \exp\{-\exp(z-\mu_{J})\}\)</span>, where
<span class="math inline">\(\mu_J=\log\{V_J(\boldsymbol{1})_{|J|})\}\)</span>
and <span class="math inline">\(0 \leq \mu_J \leq \log(|J|)\)</span>.
This follows from the homogeneity of the exponent measure. <span class="citation">Gabda et al. (2012)</span> propose a
probability-probability plot based on fitting <span class="math inline">\(\mu_J\)</span> through maximum likelihood with the
parameter constraints for each set of <span class="math inline">\(|J|\)</span> stations. The data are obtained by
pooling replications of the max-stable field and selecting all subsets
of size <span class="math inline">\(|J|\)</span> if <span class="math inline">\(\binom{D}{|J|}\)</span> is small, or else a
limited number of stations among those that display the higher
dependence so as to maximize the power of the test (independence being a
special case of max-stability). Uncertainty quantification is performed
using a nonparametric bootstrap. The function <code>maxstabtest</code>
implements this for the special case <span class="math inline">\(J=D\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lbelzile/mev/" class="external-link">mev</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>
<span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmev.html">rmev</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">1000</span>,
  d <span class="op">=</span> <span class="fl">5</span>,
  param <span class="op">=</span> <span class="fl">0.1</span>,
  model <span class="op">=</span> <span class="st">"neglog"</span>
<span class="op">)</span>
<span class="va">fgev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.gev.html">fit.gev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">fgev</span><span class="op">$</span><span class="va">estimate</span></code></pre></div>
<pre><code><span class="co">##       loc     scale     shape </span>
<span class="co">## 0.9954939 0.9919429 0.9867670</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Test of max-stability</span>
<span class="fu"><a href="../reference/maxstabtest.html">maxstabtest</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">samp</span><span class="op">)</span>
<span class="co"># Probability-probability plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fgev</span>, which <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p><img src="04-simulation_files/figure-html/maxstabtest-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The likelihood of max-stable processes is untractable, so inference
is typically performed using composite likelihood. The package
<code>evd</code> includes routines for doing this in the bivariate
setting (see <code>fbvpot</code>).</p>
<p>Consider a collection of independent and identically distributed
vectors <span class="math inline">\(\boldsymbol{X}\)</span> with
continuous marginal distributions that are in the max-domain of
attraction of a max-stable distribution with limit measure <span class="math inline">\(\Lambda\)</span>. One can transform the
observations <span class="math inline">\(\boldsymbol{X}_i\)</span> into
pseudo-uniform samples using the empirical distribution function or else
the semi-parametric estimator, <span class="math display">\[\begin{align}
\check{F}_j(x) =
\begin{cases}
\mathrm{I}\{i: y_{ij} \leq x\}/(n+1), &amp;  x \leq u_j,\\
1-\{1-\tilde{F}_j(u_j)\}\left\{1+\hat{\xi}\left(\frac{x-u_j}{\hat{\tau}_j}\right)\right\}^{-1/\hat{\xi}_j}_{+},
&amp; x &gt;u_j.
\end{cases}
\end{align}\]</span> (see <code>spunif</code>). We can back-transform
the pseudo-uniform samples <span class="math inline">\(u_{ij} =
\check{F}_j(y_{ij})\)</span> to unit Pareto using the quantile
transform, <span class="math inline">\(z_{ij}^{\mathrm{p}} =
1/1-(u_{ij})\)</span>. If we map the random vector <span class="math inline">\(\boldsymbol{Z}^{\mathrm{p}}\)</span> to
pseudo-polar coordinates, <span class="math inline">\(\boldsymbol{Z}^{\mathrm{p}} \mapsto (R,
\boldsymbol{\Omega})\)</span> from <span class="math inline">\(\mathbb{R}^D_{+} \to (0, \infty) \times
\mathbb{S}_1\)</span>, where <span class="math inline">\(\mathbb{S}_1=\{
\boldsymbol{\omega} \in \mathbb{R}^D_{+}:
\|\boldsymbol{\omega}\|_1=1\}\)</span> is the <span class="math inline">\(\ell_1\)</span>-simplex. The measure <span class="math inline">\(\Lambda\)</span> factorizes as a product measure
<span class="math inline">\(\Lambda(\mathrm{d} \boldsymbol{z}) = D
\zeta^{-2}\mathrm{d} \zeta \rho_1(\mathrm{d}
\boldsymbol{\omega})\)</span> with angular measure <span class="math inline">\(\rho_1\)</span>, a probability measure satisfying
the moment constraint <span class="math inline">\(D\int_{\mathbb{S}_1}
\omega_j \rho_1(\mathrm{d} \boldsymbol{\omega})=1\)</span> for <span class="math inline">\(j=1, \ldots, D\)</span>; this moment constraint
holds for any <span class="math inline">\(\rho_1\)</span>, whereas it
will be measure dependent if the radial measure is not <span class="math inline">\(\|\cdot \|_1\)</span> <span class="citation">(Einmahl and Segers 2009)</span>. We can thus create an
approximate sample <span class="math inline">\(\boldsymbol{\omega}\)</span> from the angular
measure <span class="math inline">\(\rho_1\)</span> and estimate its
distribution non-parametrically as <span class="math display">\[\hat{H}(w) = \sum_{i=1}^N
\hat{p}_i\mathrm{I}\{\omega_i \leq w\},\]</span> where the weights <span class="math inline">\(\hat{p}_i\)</span> are obtained as the solution of
either the empirical or Euclidean likelihood problems with a mean
constraint <span class="citation">Einmahl and Segers (2009)</span>.
Since the resulting spectral distribution is discrete (which is
problematic in simulations), <span class="citation">Carvalho et al.
(2013)</span> suggest fitting a Dirichlet kernel to observations, with
parameters <span class="math inline">\(\nu \boldsymbol{w}_i (i=1,
\ldots, D)\)</span> subject to the constraint <span class="math inline">\(\|\nu\boldsymbol{w}_{i}\|_1=1\)</span>.
The’bandwidth’ tuning parameter <span class="math inline">\(\nu\)</span>
is chosen via cross-validation. The function <code>angmeasdir</code>
fits Euclidean likelihood and returns a list with the weights vector
<code>wts</code>, the cross-validation parameter <code>nu</code> and a
<span class="math inline">\(n \times D\)</span> matrix of parameters for
the Dirichlet distribution.</p>
<p>Alternatively, we can estimate the limiting spectral measure from the
pseudo-observations enforcing the mean constraint using empirical
likelihood, as proposed by <span class="citation">Einmahl and Segers
(2009)</span>. The function <code>angmeas</code> computes the weights
associated to each observations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">samp</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/rmev.html">rmev</a></span><span class="op">(</span>
    n <span class="op">=</span> <span class="fl">1000</span>,
    d <span class="op">=</span> <span class="fl">3</span>,
    param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">2.9</span>, <span class="fl">0.1</span><span class="op">)</span>,
    model <span class="op">=</span> <span class="st">"sdir"</span>
  <span class="op">)</span>
<span class="fu"><a href="../reference/taildep.html">taildep</a></span><span class="op">(</span><span class="va">samp</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eta <span class="op">=</span> <span class="st">"betacop"</span>, chi <span class="op">=</span> <span class="st">"betacop"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="04-simulation_files/figure-html/angdensplot-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the probability weights and compute the column mean</span>
<span class="va">nparangmeas</span> <span class="op">&lt;-</span> <span class="fu">mev</span><span class="fu">::</span><span class="fu"><a href="../reference/angmeas.html">angmeas</a></span><span class="op">(</span><span class="va">samp</span>, th <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nparangmeas</span><span class="op">$</span><span class="va">wts</span>, 
     ylab <span class="op">=</span> <span class="st">"weights"</span>, 
     xlab <span class="op">=</span> <span class="st">"observation index"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nparangmeas</span><span class="op">$</span><span class="va">ang</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="04-simulation_files/figure-html/plotweights-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">nparangmeas</span><span class="op">$</span><span class="va">wts</span> <span class="op">*</span> <span class="va">nparangmeas</span><span class="op">$</span><span class="va">ang</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.3333333 0.3333333</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dirangmeas</span> <span class="op">&lt;-</span> <span class="fu">mev</span><span class="fu">::</span><span class="fu"><a href="../reference/angmeasdir.html">angmeasdir</a></span><span class="op">(</span><span class="va">samp</span>, th <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extremal-coefficient">Extremal coefficient<a class="anchor" aria-label="anchor" href="#extremal-coefficient"></a>
</h2>
<p>As in <code>SpatialExtremes</code>, we can use the nonparametric
estimates of the extremal coefficient as goodness-of-fit diagnostic. The
following code samples data</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coord</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>
<span class="va">di</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">coord</span><span class="op">)</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/rmev.html">rmev</a></span><span class="op">(</span>
    n <span class="op">=</span> <span class="fl">1000</span>,
    d <span class="op">=</span> <span class="fl">100</span>,
    param <span class="op">=</span> <span class="fl">3</span>,
    sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">di</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>,
    model <span class="op">=</span> <span class="st">'xstud'</span>
  <span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extcoef.html">extcoef</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, coord <span class="op">=</span> <span class="va">coord</span><span class="op">)</span></code></pre></div>
<p><img src="04-simulation_files/figure-html/extcoef-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extremal Student extremal coefficient function</span>
<span class="va">XT.extcoeffun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">h</span>, <span class="va">nu</span>, <span class="va">corrfun</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.function.html" class="external-link">is.function</a></span><span class="op">(</span><span class="va">corrfun</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">'Invalid function `corrfun`.'</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span><span class="op">)</span>
  <span class="va">rhoh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">corrfun</span>, <span class="va">...</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">h</span>, extcoef <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">nu</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rhoh</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">rhoh</span><span class="op">)</span><span class="op">)</span>, <span class="va">nu</span> <span class="op">+</span>
                                  <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#This time, only one graph with theoretical extremal coef</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="va">res</span><span class="op">$</span><span class="va">dist</span>,
  <span class="va">res</span><span class="op">$</span><span class="va">extcoef</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
  pch <span class="op">=</span> <span class="fl">20</span>,
  ylab <span class="op">=</span> <span class="st">"extremal coefficient"</span>,
  xlab <span class="op">=</span> <span class="st">"distance"</span>
<span class="op">)</span>
<span class="va">extcoefxt</span> <span class="op">&lt;-</span> <span class="fu">XT.extcoeffun</span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
  nu <span class="op">=</span> <span class="fl">3</span>,
  corrfun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">extcoefxt</span><span class="op">[</span>, <span class="st">'h'</span><span class="op">]</span>,
      <span class="va">extcoefxt</span><span class="op">[</span>, <span class="st">'extcoef'</span><span class="op">]</span>,
      type <span class="op">=</span> <span class="st">'l'</span>,
      col <span class="op">=</span> <span class="st">'blue'</span>,
      lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="04-simulation_files/figure-html/extcoef-2.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="generalized-r-pareto-processes-for-functional-threshold-exceedances">Generalized R-Pareto processes for functional threshold
exceedances<a class="anchor" aria-label="anchor" href="#generalized-r-pareto-processes-for-functional-threshold-exceedances"></a>
</h2>
<p>We simulate a spatial generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto process.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">650</span>, <span class="fl">720</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">215</span>, <span class="fl">290</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="co"># Create a grid</span>
<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span>
<span class="va">coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>
<span class="va">dianiso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span><span class="va">coord</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="va">sgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">grid</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># Specify marginal parameters `loc` and `scale` over grid</span>
<span class="va">eta</span> <span class="op">&lt;-</span> <span class="fl">26</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.16</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">9</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.04</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>
<span class="co"># Parameter matrix of Huesler--Reiss</span>
<span class="co"># associated to power variogram</span>
<span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">dianiso</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span> <span class="op">^</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span>
<span class="co"># Simulate generalized max-Pareto field above u=50</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">345</span><span class="op">)</span>
<span class="va">simu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rgparp.html">rgparp</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">1</span>,
  thresh <span class="op">=</span> <span class="fl">50</span>,
  shape <span class="op">=</span> <span class="fl">0.1</span>,
  riskf <span class="op">=</span> <span class="st">"max"</span>,
  scale <span class="op">=</span> <span class="va">tau</span>,
  loc <span class="op">=</span> <span class="va">eta</span>,
  sigma <span class="op">=</span> <span class="va">Lambda</span>,
  model <span class="op">=</span> <span class="st">"hr"</span>
<span class="op">)</span>
<span class="co"># The same, but conditional on an exceedance at a site</span>
<span class="va">simu2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rgparp.html">rgparp</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">1</span>,
  thresh <span class="op">=</span> <span class="fl">50</span>,
  shape <span class="op">=</span> <span class="fl">0.1</span>,
  riskf <span class="op">=</span> <span class="st">"site"</span>,
  siteindex <span class="op">=</span> <span class="fl">1225</span>,
  scale <span class="op">=</span> <span class="va">tau</span>,
  loc <span class="op">=</span> <span class="va">eta</span>,
  sigma <span class="op">=</span> <span class="va">Lambda</span>,
  model <span class="op">=</span> <span class="st">"hr"</span>
<span class="op">)</span>
<span class="co">#Plot the generalized max-Pareto field</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu">fields</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/quilt.plot.html" class="external-link">quilt.plot</a></span><span class="op">(</span><span class="va">grid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">grid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">simu1</span>, nx <span class="op">=</span> <span class="fl">50</span>, ny <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="fu">SpatialExtremes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExtremes/man/swiss.html" class="external-link">swiss</a></span><span class="op">(</span>add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">fields</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/quilt.plot.html" class="external-link">quilt.plot</a></span><span class="op">(</span><span class="va">grid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">grid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">simu2</span>, nx <span class="op">=</span> <span class="fl">50</span>, ny <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="fu">SpatialExtremes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExtremes/man/swiss.html" class="external-link">swiss</a></span><span class="op">(</span>add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="04-simulation_files/figure-html/simuRgpareto-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Value at conditioning coordinate should be greater than 50</span>
<span class="va">simu2</span><span class="op">[</span><span class="fl">1225</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## [1] 84.81661</span></code></pre>
<p>The code snippet below fits a Brown–Resnick model with power
variogram to simulated data from the same model (based on more than one
replicate). The parameters are estimated by minimizing the squared
distance between empirical cloud of pairwise conditional probability of
exceedance and the theoretical one. We include geometric anisotropy in
the analysis.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">650</span>, <span class="fl">720</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">215</span>, <span class="fl">290</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co"># Create a grid</span>
<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span>
<span class="va">coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>
<span class="va">dianiso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span><span class="va">coord</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="va">sgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">grid</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># Specify marginal parameters `loc` and `scale` over grid</span>
<span class="va">eta</span> <span class="op">&lt;-</span> <span class="fl">26</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.16</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">9</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.04</span> <span class="op">*</span> <span class="va">sgrid</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>
<span class="co"># Parameter matrix of Huesler--Reiss</span>
<span class="co"># associated to power variogram</span>
<span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">dianiso</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span> <span class="op">^</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span>
<span class="co"># Simulate generalized max-Pareto field above u=50</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">345</span><span class="op">)</span>
<span class="va">simu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rgparp.html">rgparp</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">1000</span>,
  thresh <span class="op">=</span> <span class="fl">50</span>,
  shape <span class="op">=</span> <span class="fl">0.1</span>,
  riskf <span class="op">=</span> <span class="st">"max"</span>,
  scale <span class="op">=</span> <span class="va">tau</span>,
  loc <span class="op">=</span> <span class="va">eta</span>,
  sigma <span class="op">=</span> <span class="va">Lambda</span>,
  model <span class="op">=</span> <span class="st">"hr"</span>
<span class="op">)</span>
<span class="va">extdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extremo.html">extremo</a></span><span class="op">(</span>
  dat <span class="op">=</span> <span class="va">simu1</span>,
  margp <span class="op">=</span> <span class="fl">0.9</span>,
  coord <span class="op">=</span> <span class="va">coord</span>,
  scale <span class="op">=</span> <span class="fl">1.5</span>,
  rho <span class="op">=</span> <span class="fl">0.5</span>,
  plot <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p><img src="04-simulation_files/figure-html/fitvariocloud-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Constrained optimization</span>
<span class="co"># Minimize distance between extremal coefficient from fitted variogram</span>
<span class="va">mindistpvario</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>, <span class="va">emp</span>, <span class="va">coord</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">alpha</span> <span class="op">&lt;-</span>
    <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">alpha</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">alpha</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1e10</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">scale</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">scale</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1e10</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">a</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1e10</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1e10</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">semivariomat</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/power.vario.html">power.vario</a></span><span class="op">(</span><span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span><span class="va">coord</span>, <span class="va">a</span>, <span class="va">rho</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, scale <span class="op">=</span> <span class="va">scale</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">semivariomat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">semivariomat</span><span class="op">)</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">emp</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>
<span class="co"># constrained optimization for the parameters</span>
<span class="va">hin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.99</span> <span class="op">-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
    <span class="op">-</span><span class="fl">1e-5</span> <span class="op">+</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
    <span class="op">-</span><span class="fl">1e-5</span> <span class="op">+</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
    <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span>,
    <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,
    <span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu">alabama</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/alabama/man/auglag.html" class="external-link">auglag</a></span><span class="op">(</span>
  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">30</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span>,
  hin <span class="op">=</span> <span class="va">hin</span>,
  control.optim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parscale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">30</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,
  fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu">mindistpvario</span><span class="op">(</span><span class="va">par</span>, emp <span class="op">=</span> <span class="va">extdat</span><span class="op">[</span>, <span class="st">'prob'</span><span class="op">]</span>, coord <span class="op">=</span> <span class="va">coord</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Min(hin):  0.49999 </span>
<span class="co">## Outer iteration:  1 </span>
<span class="co">## Min(hin):  0.49999 </span>
<span class="co">## par:  0.5 30 1.5 0.5 </span>
<span class="co">## fval =   77.37 </span>
<span class="co">##  </span>
<span class="co">## Outer iteration:  2 </span>
<span class="co">## Min(hin):  0.3992261 </span>
<span class="co">## par:  0.668296 74.8862 1.39923 0.556808 </span>
<span class="co">## fval =   6.52 </span>
<span class="co">##  </span>
<span class="co">## Outer iteration:  3 </span>
<span class="co">## Min(hin):  0.3992502 </span>
<span class="co">## par:  0.668285 74.8855 1.39925 0.556807 </span>
<span class="co">## fval =   6.52 </span>
<span class="co">## </span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">opt</span><span class="op">$</span><span class="va">kkt1</span>, <span class="va">opt</span><span class="op">$</span><span class="va">kkt2</span><span class="op">)</span>
<span class="co"># Plotting the extremogram in the deformed space</span>
<span class="va">distfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span>loc <span class="op">=</span> <span class="va">coord</span>, <span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">distfa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">distfa</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">extdat</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,
  pch <span class="op">=</span> <span class="fl">20</span>,
  col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>,
  yaxs <span class="op">=</span> <span class="st">"i"</span>,
  xaxs <span class="op">=</span> <span class="st">"i"</span>,
  bty <span class="op">=</span> <span class="st">'l'</span>,
  xlab <span class="op">=</span> <span class="st">"distance"</span>,
  ylab <span class="op">=</span> <span class="st">"cond. prob. of exceedance"</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="op">(</span><span class="va">distvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span>, length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="fl">2</span>,
  lwd <span class="op">=</span> <span class="fl">2</span>,
  <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/power.vario.html">power.vario</a></span><span class="op">(</span><span class="va">distvec</span>, alpha <span class="op">=</span> <span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
  <span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="04-simulation_files/figure-html/fitvariocloud-2.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="your-turn">Your turn<a class="anchor" aria-label="anchor" href="#your-turn"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Simulate Gaussian random vector (using e.g. the function
<code>mvrnorm</code> or through the package <code>RandomFields</code>)
with independent observations and vectors with covariance matrix <span class="math inline">\(\alpha \boldsymbol{1}_D\boldsymbol{1}_D^\top +
(1-\alpha)\mathrm{diag}(\boldsymbol{1}_D)\)</span> for <span class="math inline">\(\alpha \in \{0,0.25,0.5,0.75\}\)</span>. Use
<code>maxstabtest</code> on your simulated data and comment on the
diagnostic plots.</li>
<li>Simulate 100 realizaions from a <span class="math inline">\(\mathcal{R}\)</span>-Pareto process with risk
function <span class="math inline">\(\max\)</span> and <span class="math inline">\(\min\)</span> for the Brown–Resnick model with
power variogram function <code>power.vario</code> with shape
<code>alpha = 1</code> and <code>scale = 2</code> on a grid <span class="math inline">\(\{1,2,\ldots, 4\}^2\)</span> using
<code>rparp</code> and <code>rparpcs</code>. Benchmark the two methods:
which is fastest and what is the acceptance rate of the accept-reject?
Partial sample code for doing this is given below:</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="va">depmat</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/power.vario.html">power.vario</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="../reference/distg.html">distg</a></span><span class="op">(</span><span class="va">grid</span>, scale <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
              alpha <span class="op">=</span> <span class="fl">1</span>,
              scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span>
<span class="co"># This is where composition sampling shines!</span>
<span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rparpcs.html">rparpcs</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">1000</span>,
  shape <span class="op">=</span> <span class="fl">0.1</span>,
  riskf <span class="op">=</span> <span class="st">"min"</span>,
  Lambda <span class="op">=</span> <span class="va">depmat</span>,
  model <span class="op">=</span> <span class="st">"br"</span>
<span class="op">)</span>
<span class="co">#rparp is computationally intensive with "min" - only for</span>
<span class="va">samp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rparp.html">rparp</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">1000</span>,
  shape <span class="op">=</span> <span class="fl">0.1</span>,
  riskf <span class="op">=</span> <span class="st">"max"</span>,
  sigma <span class="op">=</span> <span class="va">depmat</span>,
  model <span class="op">=</span> <span class="st">"hr"</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-deCarvalho:2013" class="csl-entry">
Carvalho, Miguel de, Boris Oumow, Johan Segers, and Michał Warchoł.
2013. <span>“A <span>E</span>uclidean Likelihood Estimator for Bivariate
Tail Dependence.”</span> <em>Communications in Statistics - Theory and
Methods</em> 42 (7): 1176–92. <a href="https://doi.org/10.1080/03610926.2012.709905" class="external-link">https://doi.org/10.1080/03610926.2012.709905</a>.
</div>
<div id="ref-deFondeville:thesis" class="csl-entry">
de Fondeville, Raphaël. 2018. <span>“Functional Peaks-over-Threshold
Analysis for Complex Extreme Events.”</span> PhD thesis, Lausanne: EPFL;
MATH. <a href="https://doi.org/10.5075/epfl-thesis-8927" class="external-link">https://doi.org/10.5075/epfl-thesis-8927</a>.
</div>
<div id="ref-Dombry:2016" class="csl-entry">
Dombry, Clément, Sebastian Engelke, and Marco Oesting. 2016.
<span>“Exact Simulation of Max-Stable Processes.”</span>
<em>Biometrika</em> 103 (2): 303–17. <a href="https://doi.org/10.1093/biomet/asw008" class="external-link">https://doi.org/10.1093/biomet/asw008</a>.
</div>
<div id="ref-Dombry/Ribatet:2015" class="csl-entry">
Dombry, Clément, and Mathieu Ribatet. 2015. <span>“Functional Regular
Variations, <span>P</span>areto Processes and Peaks over
Threshold.”</span> <em>Statistics and Its Interface</em> 8 (1): 9–17.
https://doi.org/<a href="http://dx.doi.org/10.4310/SII.2015.v8.n1.a2" class="external-link">http://dx.doi.org/10.4310/SII.2015.v8.n1.a2</a>.
</div>
<div id="ref-Einmahl:2009" class="csl-entry">
Einmahl, John H. J., and Johan Segers. 2009. <span>“Maximum Empirical
Likelihood Estimation of the Spectral Measure of an Extreme-Value
Distribution.”</span> <em>Ann. Statist.</em> 37 (5B): 2953–89. <a href="https://doi.org/10.1214/08-AOS677" class="external-link">https://doi.org/10.1214/08-AOS677</a>.
</div>
<div id="ref-Ferreira:2014" class="csl-entry">
Ferreira, Ana, and Laurens de Haan. 2014. <span>“The Generalized
<span>P</span>areto Process; with a View Towards Application and
Simulation.”</span> <em>Bernoulli</em> 20 (4): 1717–37. <a href="https://doi.org/10.3150/13-BEJ538" class="external-link">https://doi.org/10.3150/13-BEJ538</a>.
</div>
<div id="ref-Gabda:2012" class="csl-entry">
Gabda, Darmesah, Ross Towe, Jennifer Wadsworth, and Jonathan Tawn. 2012.
<span>“Discussion of <span>‘<span>S</span>tatistical Modeling of Spatial
Extremes’</span> by <span>A</span>. <span>C</span>.
<span>D</span>avison, <span>S</span>. <span>A</span>.
<span>P</span>adoan and <span>M</span>. <span>R</span>ibatet.”</span>
<em>Statistical Science</em> 27 (2): 189–92. <a href="https://doi.org/10.1214/12-STS376B" class="external-link">https://doi.org/10.1214/12-STS376B</a>.
</div>
<div id="ref-deHaan:1984" class="csl-entry">
Haan, L. de. 1984. <span>“A Spectral Representation for Max-Stable
Processes.”</span> <em>Ann. Probab.</em> 12 (4): 1194–204.<a href="http://links.jstor.org/sici?sici=0091-1798(198411)12:4&lt;1194:ASRFMP&gt;2.0.CO;2-R&amp;origin=MSN%0A%09" class="external-link">
http://links.jstor.org/sici?sici=0091-1798(198411)12:4&lt;1194:ASRFMP&gt;2.0.CO;2-R&amp;origin=MSN
</a>.
</div>
<div id="ref-Ho/Dombry:2019" class="csl-entry">
Ho, Zhen Wai Olivier, and Clément Dombry. 2019. <span>“Simple Models for
Multivariate Regular Variation and the
<span>H</span><span>ü</span>sler–<span>R</span>eiss <span>P</span>areto
Distribution.”</span> <em>Journal of Multivariate Analysis</em> 173:
525–50. https://doi.org/<a href="https://doi.org/10.1016/j.jmva.2019.04.008" class="external-link">https://doi.org/10.1016/j.jmva.2019.04.008</a>.
</div>
<div id="ref-Rootzen:2017" class="csl-entry">
Rootzén, Holger, Johan Segers, and Jennifer L. Wadsworth. 2018.
<span>“Multivariate Peaks over Thresholds Models.”</span>
<em>Extremes</em> 21 (1): 115–45. <a href="https://doi.org/10.1007/s10687-017-0294-4" class="external-link">https://doi.org/10.1007/s10687-017-0294-4</a>.
</div>
<div id="ref-Schlather:2003" class="csl-entry">
Schlather, Martin, and Jonathan A. Tawn. 2003. <span>“A Dependence
Measure for Multivariate and Spatial Extreme Values: Properties and
Inference.”</span> <em>Biometrika</em> 90 (1): 139–56. <a href="https://doi.org/10.1093/biomet/90.1.139" class="external-link">https://doi.org/10.1093/biomet/90.1.139</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop,
Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
