<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Maximum-likelihood estimation for the generalized Pareto model, including generalized linear modelling of each parameter. This function was adapted by Paul Northrop to include the gradient in the gpd.fit routine from ismev."><title>Maximum likelihood method for the generalized Pareto Model — .gpd_2D_fit • mev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum likelihood method for the generalized Pareto Model — .gpd_2D_fit"><meta property="og:description" content="Maximum-likelihood estimation for the generalized Pareto model, including generalized linear modelling of each parameter. This function was adapted by Paul Northrop to include the gradient in the gpd.fit routine from ismev."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.15</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a>
    <a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection</a>
    <a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a>
    <a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Maximum likelihood method for the generalized Pareto Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/R/gp.R" class="external-link"><code>R/gp.R</code></a></small>
      <div class="d-none name"><code>dot-gpd_2D_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Maximum-likelihood estimation for the generalized Pareto model, including generalized linear modelling of each parameter. This function was adapted by Paul Northrop to include the gradient in the <code>gpd.fit</code> routine from <code>ismev</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">.gpd_2D_fit</span><span class="op">(</span></span>
<span>  <span class="va">xdat</span>,</span>
<span>  <span class="va">threshold</span>,</span>
<span>  npy <span class="op">=</span> <span class="fl">365</span>,</span>
<span>  ydat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  siglink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  shlink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  siginit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shinit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Nelder-Mead"</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>xdat</dt>
<dd><p>numeric vector of data to be fitted.</p></dd>


<dt>threshold</dt>
<dd><p>a scalar or a numeric   vector of the same length as <code>xdat</code>.</p></dd>


<dt>npy</dt>
<dd><p>number of observations per year/block.</p></dd>


<dt>ydat</dt>
<dd><p>matrix of covariates for generalized linear modelling of the parameters (or <code>NULL</code> (the default) for stationary fitting). The number of rows should be the same as the length of <code>xdat</code>.</p></dd>


<dt>sigl</dt>
<dd><p>numeric vector of integers, giving the columns of <code>ydat</code> that contain covariates for generalized linear modelling of the scale parameter (or <code>NULL</code> (the default) if the corresponding parameter is stationary).</p></dd>


<dt>shl</dt>
<dd><p>numeric vector of integers, giving the columns of <code>ydat</code> that contain covariates for generalized linear modelling of the shape parameter (or <code>NULL</code> (the default) if the corresponding parameter is stationary).</p></dd>


<dt>siglink</dt>
<dd><p>inverse link functions for generalized linear modelling of the scale parameter</p></dd>


<dt>shlink</dt>
<dd><p>inverse link functions for generalized linear modelling of the shape parameter</p></dd>


<dt>siginit</dt>
<dd><p>numeric giving initial value(s) for parameter estimates. If <code>NULL</code> the default is <code>sqrt(6 * var(xdat))/pi</code></p></dd>


<dt>shinit</dt>
<dd><p>numeric giving initial value(s) for the shape parameter estimate; if <code>NULL</code>, this is 0.1.  If using parameter covariates, then these values are used for the constant term, and zeros for all other terms.</p></dd>


<dt>show</dt>
<dd><p>logical; if <code>TRUE</code> (default), print details of the fit.</p></dd>


<dt>method</dt>
<dd><p>optimization method (see <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> for details).</p></dd>


<dt>maxit</dt>
<dd><p>maximum number of iterations.</p></dd>


<dt>...other</dt>
<dd><p>control parameters for the optimization. These are passed to components of the <code>control</code> argument of <code>optim</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list with components</p><dl><dt>nexc</dt>
<dd><p>scalar giving the number of threshold exceedances.</p></dd>

<dt>nllh</dt>
<dd><p>scalar giving the negative log-likelihood value.</p></dd>

<dt>mle</dt>
<dd><p>numeric vector giving the MLE's for the scale and shape parameters, resp.</p></dd>

 <dt>rate</dt>
<dd><p>scalar giving the estimated probability of exceeding the threshold.</p></dd>

 <dt>se</dt>
<dd><p>numeric vector giving the standard error estimates for the scale and shape parameter estimates, resp.</p></dd>

<dt>trans</dt>
<dd><p>logical indicator for a non-stationary fit.</p></dd>

<dt>model</dt>
<dd><p>list with components <code>sigl</code> and <code>shl</code>.</p></dd>

<dt>link</dt>
<dd><p>character vector giving inverse link functions.</p></dd>

<dt>threshold</dt>
<dd><p>threshold, or vector of thresholds.</p></dd>

<dt>nexc</dt>
<dd><p>number of data points above the threshold.</p></dd>

<dt>data</dt>
<dd><p>data that lie above the threshold. For non-stationary models, the data are standardized.</p></dd>

<dt>conv</dt>
<dd><p>convergence code, taken from the list returned by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>. A zero indicates successful convergence.</p></dd>

<dt>nllh</dt>
<dd><p>negative log likelihood evaluated at the maximum likelihood estimates.</p></dd>

<dt>vals</dt>
<dd><p>matrix with three columns containing the maximum likelihood estimates of the scale and shape parameters, and the threshold, at each data point.</p></dd>

<dt>mle</dt>
<dd><p>vector containing the maximum likelihood estimates.</p></dd>

<dt>rate</dt>
<dd><p>proportion of data points that lie above the threshold.</p></dd>

<dt>cov</dt>
<dd><p>covariance matrix.</p></dd>

<dt>se</dt>
<dd><p>numeric vector containing the standard errors.</p></dd>

<dt>n</dt>
<dd><p>number of data points (i.e., the length of <code>xdat</code>).</p></dd>

<dt>npy</dt>
<dd><p>number of observations per year/block.</p></dd>

<dt>xdata</dt>
<dd><p>data that has been fitted.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For non-stationary fitting it is recommended that the covariates within the generalized linear models are (at least approximately) centered and scaled (i.e. the columns of <code>ydat</code> should be approximately centered and scaled).</p>
<p>The form of the GP model used follows Coles (2001) Eq (4.7).  In particular, the shape parameter is defined so that positive values imply a heavy tail and negative values imply a bounded upper value.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Coles, S., 2001.  An Introduction to Statistical Modeling of Extreme Values.  Springer-Verlag, London.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop, Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

