<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Coefficient of tail correlation and tail dependence — taildep • mev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Coefficient of tail correlation and tail dependence — taildep"><meta name="description" content='For data with unit Pareto margins, the coefficient of tail dependence \(\eta\) is defined  via $$\Pr(\min(X) &amp;gt; x) = L(x)x^{-1/\eta},$$
where \(L(x)\) is a slowly varying function. Ignoring the latter, several estimators of \(\eta\) can be defined. In unit Pareto margins, \(\eta\) is a nonnegative shape parameter that can be estimated by fitting a generalized Pareto distribution above a high threshold. In exponential margins, \(\eta\) is a scale parameter and the maximum likelihood estimator of the latter is the Hill estimator. Both methods are based on peaks-over-threshold and the user can choose between pointwise confidence obtained through a likelihood ratio test statistic ("lrt") or the Wald statistic ("wald").'><meta property="og:description" content='For data with unit Pareto margins, the coefficient of tail dependence \(\eta\) is defined  via $$\Pr(\min(X) &amp;gt; x) = L(x)x^{-1/\eta},$$
where \(L(x)\) is a slowly varying function. Ignoring the latter, several estimators of \(\eta\) can be defined. In unit Pareto margins, \(\eta\) is a nonnegative shape parameter that can be estimated by fitting a generalized Pareto distribution above a high threshold. In exponential margins, \(\eta\) is a scale parameter and the maximum likelihood estimator of the latter is the Hill estimator. Both methods are based on peaks-over-threshold and the user can choose between pointwise confidence obtained through a likelihood ratio test statistic ("lrt") or the Wald statistic ("wald").'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.10006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a></li>
    <li><a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection</a></li>
    <li><a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a></li>
    <li><a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a></li>
    <li><a class="dropdown-item" href="../articles/mev-vignette.html">Exact unconditional sampling from max-stable random vectors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Coefficient of tail correlation and tail dependence</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/R/taildep.R" class="external-link"><code>R/taildep.R</code></a></small>
      <div class="d-none name"><code>taildep.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For data with unit Pareto margins, the coefficient of tail dependence \(\eta\) is defined  via $$\Pr(\min(X) &gt; x) = L(x)x^{-1/\eta},$$
where \(L(x)\) is a slowly varying function. Ignoring the latter, several estimators of \(\eta\) can be defined. In unit Pareto margins, \(\eta\) is a nonnegative shape parameter that can be estimated by fitting a generalized Pareto distribution above a high threshold. In exponential margins, \(\eta\) is a scale parameter and the maximum likelihood estimator of the latter is the Hill estimator. Both methods are based on peaks-over-threshold and the user can choose between pointwise confidence obtained through a likelihood ratio test statistic (<code>"lrt"</code>) or the Wald statistic (<code>"wald"</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">taildep</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  u <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nq <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  qlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>  depmeas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eta"</span>, <span class="st">"chi"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"emp"</span>, <span class="st">"betacop"</span>, <span class="st">"gpd"</span>, <span class="st">"hill"</span><span class="op">)</span>, chi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"emp"</span>, <span class="st">"betacop"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  confint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wald"</span>, <span class="st">"lrt"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  trunc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  empirical.transformation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ties.method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an \(n\) by \(d\) matrix of multivariate observations</p></dd>


<dt id="arg-u">u<a class="anchor" aria-label="anchor" href="#arg-u"></a></dt>
<dd><p>vector of percentiles between 0 and 1</p></dd>


<dt id="arg-nq">nq<a class="anchor" aria-label="anchor" href="#arg-nq"></a></dt>
<dd><p>number of quantiles of the structural variable at which to form a grid; only used if <code>u = NULL</code>.</p></dd>


<dt id="arg-qlim">qlim<a class="anchor" aria-label="anchor" href="#arg-qlim"></a></dt>
<dd><p>limits for the sequence <code>u</code> of the structural variable</p></dd>


<dt id="arg-depmeas">depmeas<a class="anchor" aria-label="anchor" href="#arg-depmeas"></a></dt>
<dd><p>dependence measure, either of <code>"eta"</code> or <code>"chi"</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>named list giving the estimation method for <code>eta</code> and <code>chi</code>. Default to <code>"emp"</code> for both.</p></dd>


<dt id="arg-confint">confint<a class="anchor" aria-label="anchor" href="#arg-confint"></a></dt>
<dd><p>string indicating the type of confidence interval for \(\eta\), one of <code>"wald"</code> or <code>"lrt"</code></p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>the confidence level required (default to 0.95).</p></dd>


<dt id="arg-trunc">trunc<a class="anchor" aria-label="anchor" href="#arg-trunc"></a></dt>
<dd><p>logical indicating whether the estimates and confidence intervals should be truncated in \([0,1]\)</p></dd>


<dt id="arg-empirical-transformation">empirical.transformation<a class="anchor" aria-label="anchor" href="#arg-empirical-transformation"></a></dt>
<dd><p>logical indicating whether observations should be transformed to pseudo-uniform scale (default to <code>TRUE</code>); otherwise, they are assumed to be uniform</p></dd>


<dt id="arg-ties-method">ties.method<a class="anchor" aria-label="anchor" href="#arg-ties-method"></a></dt>
<dd><p>string indicating the type of method for <code>rank</code>; see <code><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></code> for a list of options. Default to <code>"random"</code></p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical; should graphs be plotted?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code>plot</code>; current support for <code>main</code>, <code>xlab</code>, <code>ylab</code>, <code>add</code> and further <code>pch</code>, <code>lty</code>, <code>type</code>, <code>col</code> for points; additional arguments for confidence intervals are handled via <code>cipch</code>, <code>cilty</code>, <code>citype</code>, <code>cicol</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a named list with elements</p><ul><li><p><code>u</code>: a <code>K</code> vector of percentile levels</p></li>
<li><p><code>eta</code>: a <code>K</code> by 3 matrix with point estimates, lower and upper confidence intervals</p></li>
<li><p><code>chi</code>: a <code>K</code> by 3 matrix with point estimates, lower and upper confidence intervals</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The most common approach for estimation is the empirical survival copula, by evaluating the proportion of sample minima with uniform margins that exceed a given \(x\). An alternative estimator uses a smoothed estimator of the survival copula using Bernstein polynomial, resulting in the so-called <code>betacop</code> estimator. Approximate pointwise confidence confint for the latter are obtained by assuming the proportion of points is binomial.</p>
<p>The coefficient of tail correlation \(\chi\) is
$$\chi = \lim_{u \to 1} \frac{\Pr(F_1(X_1)&gt;u, \ldots, F_D(X_D)&gt;u)}{1-u}.$$
Asymptotically independent vectors have \(\chi = 0\). The estimator uses an estimator of the survival copula</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>As of version 1.15, the percentiles used are from the minimum variable. This ensures that, regardless of the number of variables,
there is no error message returned because the quantile levels are too low for there to be observations</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/evd/man/chiplot.html" class="external-link">chiplot</a></code> for bivariate empirical estimates of \(\chi\) and \(\bar{\chi}\).</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">765</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Max-stable model</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="rmev.html">rmev</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, d <span class="op">=</span> <span class="fl">4</span>, param <span class="op">=</span> <span class="fl">0.7</span>, model <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">taildep</span><span class="op">(</span><span class="va">dat</span>, confint <span class="op">=</span> <span class="st">'wald'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop, Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

