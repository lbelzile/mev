<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized quantile threshold selection — thselect.expgqt • mev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized quantile threshold selection — thselect.expgqt"><meta name="description" content="The methodology proposed by Beirlant, Vynckier and Teugels (1996)
uses an asymptotic expansion of the mean squared error for Hill's estimator given
a random sample with Pareto tails and positive shape, using an exponential regression.
The value of k is selected to minimize the mean squared error given optimal weighting scheme. This
depends on the order of regular variation \(\rho\), which is obtained based on the slope of the difference
in Hill estimators, suitably reweighted. The iterative procedure of Beirlant et al. alternates between parameter estimation
until convergence. It returns the Hill shape estimate, the number of higher order statistic, the parameter rho and
estimates of the standard error of the shape and the mean squared error, based on the ultimate parameter values.
Since the weights can become negative, there is no guarantee that the mean squared error estimate is positive, nor that
the estimated value of \(\rho\) is nonpositive."><meta property="og:description" content="The methodology proposed by Beirlant, Vynckier and Teugels (1996)
uses an asymptotic expansion of the mean squared error for Hill's estimator given
a random sample with Pareto tails and positive shape, using an exponential regression.
The value of k is selected to minimize the mean squared error given optimal weighting scheme. This
depends on the order of regular variation \(\rho\), which is obtained based on the slope of the difference
in Hill estimators, suitably reweighted. The iterative procedure of Beirlant et al. alternates between parameter estimation
until convergence. It returns the Hill shape estimate, the number of higher order statistic, the parameter rho and
estimates of the standard error of the shape and the mean squared error, based on the ultimate parameter values.
Since the weights can become negative, there is no guarantee that the mean squared error estimate is positive, nor that
the estimated value of \(\rho\) is nonpositive."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.10007</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a></li>
    <li><a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection</a></li>
    <li><a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a></li>
    <li><a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a></li>
    <li><a class="dropdown-item" href="../articles/mev-vignette.html">Exact unconditional sampling from max-stable random vectors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generalized quantile threshold selection</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/R/genquantselect.R" class="external-link"><code>R/genquantselect.R</code></a></small>
      <div class="d-none name"><code>thselect.expgqt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The methodology proposed by Beirlant, Vynckier and Teugels (1996)
uses an asymptotic expansion of the mean squared error for Hill's estimator given
a random sample with Pareto tails and positive shape, using an exponential regression.
The value of <code>k</code> is selected to minimize the mean squared error given optimal weighting scheme. This
depends on the order of regular variation \(\rho\), which is obtained based on the slope of the difference
in Hill estimators, suitably reweighted. The iterative procedure of Beirlant et al. alternates between parameter estimation
until convergence. It returns the Hill shape estimate, the number of higher order statistic, the parameter <code>rho</code> and
estimates of the standard error of the shape and the mean squared error, based on the ultimate parameter values.
Since the weights can become negative, there is no guarantee that the mean squared error estimate is positive, nor that
the estimated value of \(\rho\) is nonpositive.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">thselect.expgqt</span><span class="op">(</span></span>
<span>  <span class="va">xdat</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  kmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">xdat</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  kmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">xdat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xdat">xdat<a class="anchor" aria-label="anchor" href="#arg-xdat"></a></dt>
<dd><p>[vector] sample of exceedances</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>[int] maximum number of iteration</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>[double] tolerance for difference in value of \(k\) for the fixed point</p></dd>


<dt id="arg-kmin">kmin<a class="anchor" aria-label="anchor" href="#arg-kmin"></a></dt>
<dd><p>[int] minimum number of exceedances for the estimator</p></dd>


<dt id="arg-kmax">kmax<a class="anchor" aria-label="anchor" href="#arg-kmax"></a></dt>
<dd><p>[int] maximum number of exceedances for the estimator</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments, currently ignored</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list with components</p><ul><li><p><code>shape</code> the Hill estimator of the shape, based on the <code>k</code> largest order statistics</p></li>
<li><p><code>k0</code> number of high order statistics for estimation of the shape using Hill's estimator</p></li>
<li><p><code>rho</code> estimate of the second order regular variation parameter</p></li>
<li><p><code>mse</code> mean squared error estimate of the shape parameter</p></li>
<li><p><code>se</code> standard error of the shape parameter</p></li>
<li><p><code>convergence</code> logical; if <code>TRUE</code>, indicates that the method converged to a fixed point within <code>tol</code> before reaching the maximum number of iterations <code>maxiter</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Beirlant, J., Vynckier, P., &amp; Teugels, J. L. (1996). Excess Functions and Estimation of the Extreme-Value Index. <em>Bernoulli</em>, 2(<b>4</b>), 293–318. <a href="https://doi.org/10.2307/3318416" class="external-link">doi:10.2307/3318416</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate Pareto data - log(xdat) is exponential with rate 2</span></span></span>
<span class="r-in"><span><span class="va">xdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="gpdist.html">rgp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, loc <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">0.5</span>, shape <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="fu">thselect.expgqt</span><span class="op">(</span><span class="va">xdat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Threshold selection method: Beirlant, Vynckier and Teugels (1996)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized quantile threshold selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selected threshold: 3.829 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of exceedances: 22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shape estimate: 0.001 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop, Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

