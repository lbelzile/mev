<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extremal index estimators based on interexceedance time and gap of exceedances — ext.index • mev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extremal index estimators based on interexceedance time and gap of exceedances — ext.index"><meta name="description" content="The function implements the maximum likelihood estimator and iteratively reweighted least
square estimators of Suveges (2007)  as well as the intervals estimator. The implementation
differs from the presentation of the paper in that an iteration limit is enforced to make sure
the iterative procedure terminates. Multiple thresholds can be supplied."><meta property="og:description" content="The function implements the maximum likelihood estimator and iteratively reweighted least
square estimators of Suveges (2007)  as well as the intervals estimator. The implementation
differs from the presentation of the paper in that an iteration limit is enforced to make sure
the iterative procedure terminates. Multiple thresholds can be supplied."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.10006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a></li>
    <li><a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection</a></li>
    <li><a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a></li>
    <li><a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a></li>
    <li><a class="dropdown-item" href="../articles/mev-vignette.html">Exact unconditional sampling from max-stable random vectors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extremal index estimators based on interexceedance time and gap of exceedances</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/R/infomattest.R" class="external-link"><code>R/infomattest.R</code></a></small>
      <div class="d-none name"><code>ext.index.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function implements the maximum likelihood estimator and iteratively reweighted least
square estimators of Suveges (2007)  as well as the intervals estimator. The implementation
differs from the presentation of the paper in that an iteration limit is enforced to make sure
the iterative procedure terminates. Multiple thresholds can be supplied.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ext.index</span><span class="op">(</span></span>
<span>  <span class="va">xdat</span>,</span>
<span>  quantile <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wls"</span>, <span class="st">"mle"</span>, <span class="st">"intervals"</span><span class="op">)</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xdat">xdat<a class="anchor" aria-label="anchor" href="#arg-xdat"></a></dt>
<dd><p>numeric vector of observations</p></dd>


<dt id="arg-quantile">quantile<a class="anchor" aria-label="anchor" href="#arg-quantile"></a></dt>
<dd><p>a vector of quantile levels in (0,1) for estimation of the extremal index. Defaults to 0.95</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a string specifying the chosen method. Must be either <code>wls</code>
for weighted least squares, <code>mle</code> for maximum likelihood estimation or <code>intervals</code>
for the intervals estimator of Ferro and Segers (2003). Partial match is allowed.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical; if <code>TRUE</code>, plot the extremal index as a function of <code>q</code></p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical; if <code>TRUE</code>, receive a warning when the sample size is too small</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a vector or matrix of estimated extremal index of dimension <code>length(method)</code> by <code>length(q)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The iteratively reweighted least square is a procedure based on the gaps of exceedances \(S_n=T_n-1\)
The model is first fitted to non-zero gaps, which are rescaled to have unit exponential scale. The slope
between the theoretical quantiles and the normalized gap of exceedances is \(b=1/\theta\),
with intercept \(a=\log(\theta)/\theta\).
As such, the estimate of the extremal index is based on \(\hat{\theta}=\exp(\hat{a}/\hat{b})\).
The weights are chosen in such a way as to reduce the influence of the smallest values.
The estimator exploits the dual role of \(\theta\) as the parameter of the mean for
the interexceedance time as well as the mixture proportion for the non-zero component.</p>
<p>The maximum likelihood is based on an independence likelihood for the rescaled gap of exceedances,
namely \(\bar{F}(u_n)S(u_n)\). The score equation is equivalent to a quadratic equation in
\(\theta\) and the maximum likelihood estimate is available in closed form.
Its validity requires however condition \(D^{(2)}(u_n)\) to apply;
this should be checked by the user beforehand.</p>
<p>A warning is emitted if the effective sample size is less than 50 observations.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ferro and Segers (2003). Inference for clusters of extreme values,
JRSS: Series B, <strong>65</strong>(2), 545-556.</p>
<p>Suveges (2007) Likelihood estimation of the extremal index. <em>Extremes</em>,
 <strong>10</strong>(1), 41-55.</p>
<p>Suveges and Davison (2010), Model misspecification in peaks over threshold analysis. <em>Annals of Applied Statistics</em>, <strong>4</strong>(1), 203-221.</p>
<p>Fukutome, Liniger and Suveges (2015), Automatic threshold and run parameter selection: a climatology
for extreme hourly precipitation in Switzerland. <em>Theoretical and Applied Climatology</em>,
<strong>120</strong>(3), 403-416.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Leo Belzile</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Moving maxima model with theta=0.5</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span>; <span class="va">theta</span> <span class="op">&lt;-</span>  <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="gevdist.html">rgev</a></span><span class="op">(</span><span class="fl">10001</span>, loc<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">a</span><span class="op">)</span>,scale<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">a</span><span class="op">)</span>,shape<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">sim</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="va">a</span>,<span class="va">sim</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.99</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ext.index</span><span class="op">(</span>xdat <span class="op">=</span> <span class="va">x</span>, quantile <span class="op">=</span> <span class="va">q</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span> <span class="op">(</span><span class="st">'wls'</span>, <span class="st">'mle'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           90%      91%       92%       93%       94%       95%       96%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wls 0.6314522 0.633461 0.6381835 0.6410253 0.6501045 0.6677165 0.6685871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mle 0.4801204 0.480535 0.4832988 0.4884225 0.4864203 0.4868270 0.4931644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           97%       98%       99%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wls 0.6453696 0.6821534 0.6503444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mle 0.4909889 0.4989578 0.5003508</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop, Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

