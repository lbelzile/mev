<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function provides the log-likelihood and quantiles for the three different families presented
in Papastathopoulos and Tawn (2013). The latter include an additional parameter, \(\kappa\).
All three families share the same tail index as the generalized Pareto distribution, while allowing for lower thresholds.
In the case \(\kappa=1\), the models reduce to the generalised Pareto.
egp.retlev gives the return levels for the extended generalised Pareto distributions"><title>Extended generalised Pareto families — egp • mev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extended generalised Pareto families — egp"><meta property="og:description" content="This function provides the log-likelihood and quantiles for the three different families presented
in Papastathopoulos and Tawn (2013). The latter include an additional parameter, \(\kappa\).
All three families share the same tail index as the generalized Pareto distribution, while allowing for lower thresholds.
In the case \(\kappa=1\), the models reduce to the generalised Pareto.
egp.retlev gives the return levels for the extended generalised Pareto distributions"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13.20000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a>
    <a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection tools</a>
    <a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a>
    <a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extended generalised Pareto families</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/R/penultimate.R" class="external-link"><code>R/penultimate.R</code></a></small>
      <div class="d-none name"><code>egp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides the log-likelihood and quantiles for the three different families presented
in Papastathopoulos and Tawn (2013). The latter include an additional parameter, \(\kappa\).
All three families share the same tail index as the generalized Pareto distribution, while allowing for lower thresholds.
In the case \(\kappa=1\), the models reduce to the generalised Pareto.</p>
<p><code>egp.retlev</code> gives the return levels for the extended generalised Pareto distributions</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>xdat</dt>
<dd><p>vector of observations, greater than the threshold</p></dd>
<dt>thresh</dt>
<dd><p>threshold value</p></dd>
<dt>par</dt>
<dd><p>parameter vector (\(\kappa\), \(\sigma\),\(\xi\)).</p></dd>
<dt>model</dt>
<dd><p>a string indicating which extended family to fit</p></dd>
<dt>show</dt>
<dd><p>logical; if <code>TRUE</code>, print the results of the optimization</p></dd>
<dt>p</dt>
<dd><p>extreme event probability; <code>p</code> must be greater than the rate of exceedance for the calculation to make sense. See <b>Details</b>.</p></dd>
<dt>plot</dt>
<dd><p>boolean indicating whether or not to plot the return levels</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>egp.ll</code> returns the log-likelihood value.
<code>egp.retlev</code> returns a plot of the return levels if <code>plot=TRUE</code> and a matrix of return levels.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For return levels, the <code>p</code> argument can be related to \(T\) year exceedances as follows:
if there are \(n_y\) observations per year, than take <code>p</code>
to equal \(1/(Tn_y)\) to obtain the \(T\)-years return level.</p>
    </div>
    <div class="section level2">
    <h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h2>
    

<p><code>egp.ll(xdat, thresh, par, model=c('egp1','egp2','egp3'))</code></p>

<p><code>egp.retlev(xdat, thresh, par, model=c('egp1','egp2','egp3'), p, plot=TRUE)</code></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Papastathopoulos, I. and J. Tawn (2013). Extended generalised Pareto models for tail estimation, <em>Journal of Statistical Planning and Inference</em> <b>143</b>(3), 131--143.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Leo Belzile</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"><span class="va">xdat</span> <span class="op">&lt;-</span> <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gpd.html" class="external-link">rgpd</a></span><span class="op">(</span><span class="fl">1000</span>, loc <span class="op">=</span> <span class="fl">0</span>, scale <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit.egp.html">fit.egp</a></span><span class="op">(</span><span class="va">xdat</span>, thresh <span class="op">=</span> <span class="fl">0</span>, model <span class="op">=</span> <span class="st">'egp3'</span><span class="op">)</span><span class="op">$</span><span class="va">par</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">1500</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2000</span><span class="op">)</span></span>
<span class="r-in"><span class="co">#With multiple thresholds</span></span>
<span class="r-in"><span class="va">th</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit.egp.html">tstab.egp</a></span><span class="op">(</span><span class="va">xdat</span>, <span class="va">th</span>, model <span class="op">=</span> <span class="st">'egp1'</span><span class="op">)</span></span>
<span class="r-plt img"><img src="egp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="egp-function.html">egp.retlev</a></span><span class="op">(</span><span class="va">xdat</span>, <span class="va">opt</span><span class="op">$</span><span class="va">thresh</span>, <span class="va">opt</span><span class="op">$</span><span class="va">par</span>, <span class="st">'egp1'</span>, p <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span class="r-plt img"><img src="egp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit.egp.html">tstab.egp</a></span><span class="op">(</span><span class="va">xdat</span>, <span class="va">th</span>, model <span class="op">=</span> <span class="st">'egp2'</span>, plots <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="egp-function.html">egp.retlev</a></span><span class="op">(</span><span class="va">xdat</span>, <span class="va">opt</span><span class="op">$</span><span class="va">thresh</span>, <span class="va">opt</span><span class="op">$</span><span class="va">par</span>, <span class="st">'egp2'</span>, p <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span class="r-plt img"><img src="egp-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit.egp.html">tstab.egp</a></span><span class="op">(</span><span class="va">xdat</span>, <span class="va">th</span>, model <span class="op">=</span> <span class="st">'egp3'</span>, plots <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="egp-function.html">egp.retlev</a></span><span class="op">(</span><span class="va">xdat</span>, <span class="va">opt</span><span class="op">$</span><span class="va">thresh</span>, <span class="va">opt</span><span class="op">$</span><span class="va">par</span>, <span class="st">'egp3'</span>, p <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span class="r-plt img"><img src="egp-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop,
Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

