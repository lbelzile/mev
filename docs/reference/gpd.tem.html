<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function gpd.tem provides a tangent exponential model (TEM) approximation
for higher order likelihood inference for a scalar parameter for the generalized Pareto distribution. Options include
scale and shape parameters as well as value-at-risk (also referred to as quantiles, or return levels)
and expected shortfall. The function attempts to find good values for psi that will
cover the range of options, but the fit may fail and return an error. In such cases, the user can try to find good
grid of starting values and provide them to the routine."><title>Tangent exponential model approximation for the GP distribution — gpd.tem • mev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tangent exponential model approximation for the GP distribution — gpd.tem"><meta property="og:description" content="The function gpd.tem provides a tangent exponential model (TEM) approximation
for higher order likelihood inference for a scalar parameter for the generalized Pareto distribution. Options include
scale and shape parameters as well as value-at-risk (also referred to as quantiles, or return levels)
and expected shortfall. The function attempts to find good values for psi that will
cover the range of options, but the fit may fail and return an error. In such cases, the user can try to find good
grid of starting values and provide them to the routine."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13.10000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a>
    <a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection tools</a>
    <a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a>
    <a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tangent exponential model approximation for the GP distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/R/profile.R" class="external-link"><code>R/profile.R</code></a></small>
      <div class="d-none name"><code>gpd.tem.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>gpd.tem</code> provides a tangent exponential model (TEM) approximation
for higher order likelihood inference for a scalar parameter for the generalized Pareto distribution. Options include
scale and shape parameters as well as value-at-risk (also referred to as quantiles, or return levels)
and expected shortfall. The function attempts to find good values for <code>psi</code> that will
cover the range of options, but the fit may fail and return an error. In such cases, the user can try to find good
grid of starting values and provide them to the routine.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gpd.tem</span><span class="op">(</span>
  <span class="va">dat</span>,
  param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scale"</span>, <span class="st">"shape"</span>, <span class="st">"quant"</span>, <span class="st">"VaR"</span>, <span class="st">"ES"</span>, <span class="st">"Nmean"</span>, <span class="st">"Nquant"</span><span class="op">)</span>,
  psi <span class="op">=</span> <span class="cn">NULL</span>,
  m <span class="op">=</span> <span class="cn">NULL</span>,
  threshold <span class="op">=</span> <span class="fl">0</span>,
  n.psi <span class="op">=</span> <span class="fl">50</span>,
  N <span class="op">=</span> <span class="cn">NULL</span>,
  p <span class="op">=</span> <span class="cn">NULL</span>,
  q <span class="op">=</span> <span class="cn">NULL</span>,
  plot <span class="op">=</span> <span class="cn">FALSE</span>,
  correction <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dat</dt>
<dd><p>sample vector for the GP distribution</p></dd>
<dt>param</dt>
<dd><p>parameter over which to profile</p></dd>
<dt>psi</dt>
<dd><p>scalar or ordered vector of values for the interest parameter. If <code>NULL</code> (default), a grid of values centered at the MLE is selected. If <code>psi</code> is of length 2 and <code>n.psi</code>&gt;2, it is assumed to be the minimal and maximal values at which to evaluate the profile log likelihood.</p></dd>
<dt>m</dt>
<dd><p>number of observations of interest for return levels. See <strong>Details</strong>. Required only for <code>param = 'VaR'</code> or <code>param = 'ES'</code>.</p></dd>
<dt>threshold</dt>
<dd><p>threshold value corresponding to the lower bound of the support or the location parameter of the generalized Pareto distribution.</p></dd>
<dt>n.psi</dt>
<dd><p>number of values of <code>psi</code> at which the likelihood is computed, if <code>psi</code> is not supplied (<code>NULL</code>). Odd values are more prone to give rise to numerical instabilities near the MLE</p></dd>
<dt>N</dt>
<dd><p>size of block over which to take maxima. Required only for <code>args</code> <code>Nmean</code> and <code>Nquant</code>.</p></dd>
<dt>p</dt>
<dd><p>tail probability, equivalent to \(1/m\). Required only for <code>args</code> <code>quant</code>.</p></dd>
<dt>q</dt>
<dd><p>level of quantile for N-block maxima. Required only for <code>args</code> <code>Nquant</code>.</p></dd>
<dt>plot</dt>
<dd><p>logical indicating whether <code>plot.fr</code> should be called upon exit</p></dd>
<dt>correction</dt>
<dd><p>logical indicating whether <a href="spline.corr.html">spline.corr</a> should be called.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an invisible object of class <code>fr</code> (see <code><a href="https://rdrr.io/pkg/hoa/man/tem.html" class="external-link">tem</a></code>) with elements</p><ul><li><p><code>normal</code>: maximum likelihood estimate and standard error of the interest parameter \(psi\)</p></li>
<li><p><code>par.hat</code>: maximum likelihood estimates</p></li>
<li><p><code>par.hat.se</code>: standard errors of maximum likelihood estimates</p></li>
<li><p><code>th.rest</code>: estimated maximum profile likelihood at (\(psi\), \(\hat{\lambda}\))</p></li>
<li><p><code>r</code>: values of likelihood root corresponding to \(\psi\)</p></li>
<li><p><code>psi</code>: vector of interest parameter</p></li>
<li><p><code>q</code>: vector of likelihood modifications</p></li>
<li><p><code>rstar</code>: modified likelihood root vector</p></li>
<li><p><code>rstar.old</code>: uncorrected modified likelihood root vector</p></li>
<li><p><code>param</code>: parameter</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>As of version 1.11, this function is a wrapper around <code>gpd.pll</code>.</p>
<p>The interpretation for <code>m</code> is as follows: if there are on average \(m_y\) observations per year above the threshold, then  \(m = Tm_y\) corresponds to \(T\)-year return level.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Leo Belzile</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gpd.html" class="external-link">rgpd</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">40</span>, scale <span class="op">=</span> <span class="fl">1</span>, shape <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span>
<span class="r-in"><span class="co">#with plots</span></span>
<span class="r-in"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">gpd.tem</span><span class="op">(</span>param <span class="op">=</span> <span class="st">'shape'</span>, n.psi <span class="op">=</span> <span class="fl">50</span>, dat <span class="op">=</span> <span class="va">dat</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="gpd.tem-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="gpd.tem-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">gpd.tem</span><span class="op">(</span>param <span class="op">=</span> <span class="st">'scale'</span>, n.psi <span class="op">=</span> <span class="fl">50</span>, dat <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">gpd.tem</span><span class="op">(</span>param <span class="op">=</span> <span class="st">'VaR'</span>, n.psi <span class="op">=</span> <span class="fl">50</span>, dat <span class="op">=</span> <span class="va">dat</span>, m <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="co">#Providing psi</span></span>
<span class="r-in"><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, length <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">35</span>, length <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">gpd.tem</span><span class="op">(</span>param <span class="op">=</span> <span class="st">'ES'</span>, dat <span class="op">=</span> <span class="va">dat</span>, m <span class="op">=</span> <span class="fl">100</span>, psi <span class="op">=</span> <span class="va">psi</span>, correction <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">mev</span><span class="fu">:::</span><span class="fu"><a href="plot.fr.html">plot.fr</a></span><span class="op">(</span><span class="va">m4</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fr4</span> <span class="op">&lt;-</span> <span class="fu"><a href="spline.corr.html">spline.corr</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">m4</span>, parm <span class="op">=</span> <span class="fl">2</span>, warn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu">gpd.tem</span><span class="op">(</span>param <span class="op">=</span> <span class="st">'Nmean'</span>, dat <span class="op">=</span> <span class="va">dat</span>, N <span class="op">=</span> <span class="fl">100</span>, psi <span class="op">=</span> <span class="va">psi</span>, correction <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m6</span> <span class="op">&lt;-</span> <span class="fu">gpd.tem</span><span class="op">(</span>param <span class="op">=</span> <span class="st">'Nquant'</span>, dat <span class="op">=</span> <span class="va">dat</span>, N <span class="op">=</span> <span class="fl">100</span>, q <span class="op">=</span> <span class="fl">0.7</span>, correction <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop,
Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

