<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function returns the density and distribution functions
of the 3rd penultimate approximation for extremes of Smith (1987). It requires
knowledge of the exact constants \(\epsilon\) and \(\rho\) described in the paper."><title>Smith's third penultimate approximation — smith.penult.fn • mev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Smith's third penultimate approximation — smith.penult.fn"><meta property="og:description" content="This function returns the density and distribution functions
of the 3rd penultimate approximation for extremes of Smith (1987). It requires
knowledge of the exact constants \(\epsilon\) and \(\rho\) described in the paper."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13.20000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a>
    <a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection tools</a>
    <a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a>
    <a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Smith's third penultimate approximation</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/R/penultimate.R" class="external-link"><code>R/penultimate.R</code></a></small>
      <div class="d-none name"><code>smith.penult.fn.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function returns the density and distribution functions
of the 3rd penultimate approximation for extremes of Smith (1987). It requires
knowledge of the exact constants \(\epsilon\) and \(\rho\) described in the paper.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">smith.penult.fn</span><span class="op">(</span>
  <span class="va">loc</span>,
  <span class="va">scale</span>,
  <span class="va">shape</span>,
  <span class="va">eps</span>,
  rho <span class="op">=</span> <span class="cn">NULL</span>,
  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bm"</span>, <span class="st">"pot"</span><span class="op">)</span>,
  mdaGumbel <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>loc</dt>
<dd><p>location parameter returned by <code><a href="smith.penult.html">smith.penult</a></code> or threshold vector</p></dd>
<dt>scale</dt>
<dd><p>scale parameter returned by <code><a href="smith.penult.html">smith.penult</a></code></p></dd>
<dt>shape</dt>
<dd><p>shape parameter returned by <code><a href="smith.penult.html">smith.penult</a></code></p></dd>
<dt>eps</dt>
<dd><p>parameter vector, see <strong>Details</strong>.</p></dd>
<dt>rho</dt>
<dd><p>second-order parameter, model dependent</p></dd>
<dt>method</dt>
<dd><p>one of <code>pot</code> for the generalized Pareto or <code>bm</code> for the generalized extreme value distribution</p></dd>
<dt>mdaGumbel</dt>
<dd><p>logical indicating whether the function \(H_{\rho}\) should be replaced by \(x^3/6\); see <strong>Details</strong>.</p></dd>
<dt>...</dt>
<dd><p>additional parameters, currently ignored. These are used for backward compatibility due to a change in the names of the arguments.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Let \(F\), \(f\) denote respectively the distribution and density functions and define the function \(\phi(x)\)  as
$$\phi(x)=-\frac{F(x)\log F(x)}{f(x)}$$
for block maxima.
The sequence <code>loc</code> corresponds to \(b_n\) otherwise, defined as the solution of \(F(b_n)=\exp(-1/n)\).</p>
<p>The <code>scale</code> is given by \(a_n=\phi(b_n)\), the <code>shape</code> as \(\gamma_n=\phi'(b_n)\). These are returned by a call to <a href="smith.penult.html">smith.penult</a>.</p>
<p>For threshold exceedances, \(b_n\) is replaced by the sequence of thresholds \(u\) and we
take instead \(\phi(x)\) to be the reciprocal hazard function \(\phi(x)=(1-F(x))/f(x)\).</p>
<p>In cases where the distribution function is in the maximum domain of
attraction of the Gumbel distribution, \(\rho\) is possibly undetermined and
\(\epsilon\) can be equal to \(\phi(b_n)\phi''(b_n)\).</p>
<p>For distributions in the maximum domain of
attraction of the Gumbel distribution and that are class N, it is also possible to abstract from the \(\rho\) parameter by substituting the function \(H_{\rho}\) by \(x^3/6\) without affecting the rate of convergence. This can be done by setting <code>mdaGumbel=TRUE</code> in the function call.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    

<p>The third penultimate approximation does not yield a valid distribution function over the whole range of the original distribution, but is rather valid in a neighborhood of the true support of the distribution of maxima/threshold exceedance.
The function handles the most standard failure (decreasing distribution function and negative densities), but any oscillatory behaviour will not necessarily be captured.
This is inherent to the method and can be resolved by `not' evaluating the functions \(F\) and \(f\) at the faulty points.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Smith, R.L. (1987). Approximations in extreme value theory. <em>Technical report 205</em>, Center for Stochastic Process, University of North Carolina, 1--34.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#Normal maxima example from Smith (1987)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co">#block of size 100</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="smith.penult.html">smith.penult</a></span><span class="op">(</span>family<span class="op">=</span><span class="st">'norm'</span>,</span>
<span class="r-in">   ddensF<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="op">-</span><span class="va">x</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>, method<span class="op">=</span><span class="st">'bm'</span>, m<span class="op">=</span><span class="va">m</span>, returnList<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">approx</span> <span class="op">&lt;-</span> <span class="fu">smith.penult.fn</span><span class="op">(</span>loc<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span class="r-in">   eps<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">p</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span>, mdaGumbel<span class="op">=</span><span class="cn">TRUE</span>, method<span class="op">=</span><span class="st">'bm'</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">6</span>,by<span class="op">=</span><span class="fl">0.001</span><span class="op">)</span></span>
<span class="r-in"><span class="co">#First penultimate approximation</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">x</span>, log.p<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">'l'</span>, ylab<span class="op">=</span><span class="st">'CDF'</span>,</span>
<span class="r-in">main<span class="op">=</span><span class="st">'Distribution of the maxima of\n 100 standard normal variates'</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gev.html" class="external-link">pgev</a></span><span class="op">(</span><span class="va">x</span>,loc<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gev.html" class="external-link">pgev</a></span><span class="op">(</span><span class="va">x</span>,loc<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">approx</span><span class="op">$</span><span class="fu">F</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'bottomright'</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span class="r-in">   legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Exact'</span>,<span class="st">'1st approx.'</span>,<span class="st">'2nd approx.'</span>,<span class="st">'3rd approx'</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">'n'</span><span class="op">)</span></span>
<span class="r-plt img"><img src="smith.penult.fn-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">m</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">m</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">x</span>,log.p<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">'l'</span>, ylab<span class="op">=</span><span class="st">'Density'</span>,</span>
<span class="r-in">main<span class="op">=</span><span class="st">'Distribution of the maxima of\n 100 standard normal variates'</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gev.html" class="external-link">dgev</a></span><span class="op">(</span><span class="va">x</span>,loc<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gev.html" class="external-link">dgev</a></span><span class="op">(</span><span class="va">x</span>,loc<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="va">p</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">approx</span><span class="op">$</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'topright'</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span class="r-in"> legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Exact'</span>,<span class="st">'1st approx.'</span>,<span class="st">'2nd approx.'</span>,<span class="st">'3rd approx'</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">'n'</span><span class="op">)</span></span>
<span class="r-plt img"><img src="smith.penult.fn-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Threshold exceedances</span></span>
<span class="r-in"><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="smith.penult.html">smith.penult</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"norm"</span>, ddensF<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="op">-</span><span class="va">x</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>,</span>
<span class="r-in">method<span class="op">=</span><span class="st">'pot'</span>, u<span class="op">=</span><span class="fl">4</span>, returnList<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">approx</span> <span class="op">&lt;-</span> <span class="fu">smith.penult.fn</span><span class="op">(</span>loc<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span class="r-in"> eps<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span>, mdaGumbel<span class="op">=</span><span class="cn">TRUE</span>, method<span class="op">=</span><span class="st">'pot'</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4.01</span>,<span class="fl">7</span>,by<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span class="r-in"><span class="co">#Distribution function</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">'l'</span>, ylab<span class="op">=</span><span class="st">'Conditional CDF'</span>,</span>
<span class="r-in">main<span class="op">=</span><span class="st">'Exceedances over 4\n for standard normal variates'</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gpd.html" class="external-link">pgpd</a></span><span class="op">(</span><span class="va">x</span>, loc<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gpd.html" class="external-link">pgpd</a></span><span class="op">(</span><span class="va">x</span>, loc<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">approx</span><span class="op">$</span><span class="fu">F</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span class="r-plt img"><img src="smith.penult.fn-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co">#Density</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">'l'</span>, ylab<span class="op">=</span><span class="st">'Conditional density'</span>,</span>
<span class="r-in">main<span class="op">=</span><span class="st">'Exceedances over 4\n for standard normal variates'</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gpd.html" class="external-link">dgpd</a></span><span class="op">(</span><span class="va">x</span>, loc<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gpd.html" class="external-link">dgpd</a></span><span class="op">(</span><span class="va">x</span>, loc<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, shape<span class="op">=</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">approx</span><span class="op">$</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span class="r-plt img"><img src="smith.penult.fn-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop,
Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

