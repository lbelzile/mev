<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Parameter stability plot and maximum likelihood routine for extended GP models — fit.egp • mev</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parameter stability plot and maximum likelihood routine for extended GP models — fit.egp"><meta name="description" content="The function tstab.egp provides classical threshold stability plot for (\(\kappa\), \(\sigma\), \(\xi\)).
The fitted parameter values are displayed with pointwise normal 95% confidence intervals.
The function returns an invisible list with parameter estimates and standard errors, and p-values for the Wald test that \(\kappa=1\).
 The plot is for the modified scale (as in the generalised Pareto model) and as such it is possible that the modified scale be negative.
tstab.egp can also be used to fit the model to multiple thresholds."><meta property="og:description" content="The function tstab.egp provides classical threshold stability plot for (\(\kappa\), \(\sigma\), \(\xi\)).
The fitted parameter values are displayed with pointwise normal 95% confidence intervals.
The function returns an invisible list with parameter estimates and standard errors, and p-values for the Wald test that \(\kappa=1\).
 The plot is for the modified scale (as in the generalised Pareto model) and as such it is possible that the modified scale be negative.
tstab.egp can also be used to fit the model to multiple thresholds."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.10007</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01-univariate.html">Likelihood based inference for univariate extremes</a></li>
    <li><a class="dropdown-item" href="../articles/02-threshold.html">Threshold selection</a></li>
    <li><a class="dropdown-item" href="../articles/03-penultimate.html">Penultimate approximations</a></li>
    <li><a class="dropdown-item" href="../articles/04-simulation.html">Simulation of multivariate extreme value distributions and processes</a></li>
    <li><a class="dropdown-item" href="../articles/mev-vignette.html">Exact unconditional sampling from max-stable random vectors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbelzile/mev/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Parameter stability plot and maximum likelihood routine for extended GP models</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/mev/blob/HEAD/R/extgp.R" class="external-link"><code>R/extgp.R</code></a></small>
      <div class="d-none name"><code>fit.egp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>tstab.egp</code> provides classical threshold stability plot for (\(\kappa\), \(\sigma\), \(\xi\)).
The fitted parameter values are displayed with pointwise normal 95% confidence intervals.
The function returns an invisible list with parameter estimates and standard errors, and p-values for the Wald test that \(\kappa=1\).
 The plot is for the modified scale (as in the generalised Pareto model) and as such it is possible that the modified scale be negative.
<code>tstab.egp</code> can also be used to fit the model to multiple thresholds.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit.egp</span><span class="op">(</span></span>
<span>  <span class="va">xdat</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pt-beta"</span>, <span class="st">"pt-gamma"</span>, <span class="st">"pt-power"</span>, <span class="st">"gj-tnorm"</span>, <span class="st">"gj-beta"</span>, <span class="st">"exptilt"</span>,</span>
<span>    <span class="st">"logist"</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nelder"</span>, <span class="st">"nlminb"</span>, <span class="st">"BFGS"</span><span class="op">)</span>,</span>
<span>  fpar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xdat">xdat<a class="anchor" aria-label="anchor" href="#arg-xdat"></a></dt>
<dd><p>vector of observations, greater than the threshold</p></dd>


<dt id="arg-thresh">thresh<a class="anchor" aria-label="anchor" href="#arg-thresh"></a></dt>
<dd><p>threshold value</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a string indicating which extended family to fit</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>optional named list of initial values, with \(\kappa\), \(sigma\) or \(xi\).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the method to be used. See <b>Details</b>. Can be abbreviated.</p></dd>


<dt id="arg-fpar">fpar<a class="anchor" aria-label="anchor" href="#arg-fpar"></a></dt>
<dd><p>a named list with fixed parameters, either <code>scale</code> or <code>shape</code></p></dd>


<dt id="arg-show">show<a class="anchor" aria-label="anchor" href="#arg-show"></a></dt>
<dd><p>logical; if <code>TRUE</code>, print the results of the optimization</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters, for backward compatibility purposes</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>fit.egp</code> outputs the list returned by <a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a>, which contains the parameter values, the hessian and in addition the standard errors</p>
<p><code>tstab.egp</code> returns a plot(s) of the parameters fit over the range of provided thresholds, with pointwise normal confidence intervals; the function also returns an invisible list containing notably the matrix of point estimates (<code>par</code>) and standard errors (<code>se</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>fit.egp</code> is a numerical optimization routine to fit the extended generalised Pareto models of Papastathopoulos and Tawn (2013),
using maximum likelihood estimation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Papastathopoulos, I. and J. Tawn (2013). Extended generalised Pareto models for tail estimation, <em>Journal of Statistical Planning and Inference</em> <b>143</b>(3), 131–143.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Leo Belzile</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">xdat</span> <span class="op">&lt;-</span> <span class="fu">mev</span><span class="fu">::</span><span class="fu"><a href="gpdist.html">rgp</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  loc <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  shape <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fitted</span> <span class="op">&lt;-</span> <span class="fu">fit.egp</span><span class="op">(</span></span></span>
<span class="r-in"><span>  xdat <span class="op">=</span> <span class="va">xdat</span>,</span></span>
<span class="r-in"><span>  thresh <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"pt-gamma"</span>,</span></span>
<span class="r-in"><span>  show <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: Papastathopoulos-Tawn's EGP 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance: 184.419 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Threshold: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number Above: 42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Above: 0.42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa  scale  shape  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.311  0.777  0.914  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Errors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kappa  scale  shape  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.645  0.894  0.266  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization Information</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Convergence: successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Function Evaluations: 122 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Gradient Evaluations: NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">thresh</span> <span class="op">&lt;-</span> <span class="fu">mev</span><span class="fu">::</span><span class="fu"><a href="gpdist.html">qgp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tstab.egp.html">tstab.egp</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   xdat <span class="op">=</span> <span class="va">xdat</span>,</span></span>
<span class="r-in"><span>   thresh <span class="op">=</span> <span class="va">thresh</span>,</span></span>
<span class="r-in"><span>   model <span class="op">=</span> <span class="st">"pt-gamma"</span>,</span></span>
<span class="r-in"><span>   plots <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Modified scale not available for EGPD models.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-plt img"><img src="fit.egp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">xdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="egpdist.html">regp</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  shape <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  kappa <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"pt-power"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fit.egp</span><span class="op">(</span></span></span>
<span class="r-in"><span> xdat <span class="op">=</span> <span class="va">xdat</span>,</span></span>
<span class="r-in"><span> model <span class="op">=</span> <span class="st">"pt-power"</span>,</span></span>
<span class="r-in"><span> show <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span> fpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kappa <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> method <span class="op">=</span> <span class="st">"Nelder"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: Papastathopoulos-Tawn's EGP 3 (power) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance: 149.32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Threshold: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number Above: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Above: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  shape  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.591  0.273  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Errors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  shape  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.108  0.155  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization Information</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Convergence: successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Function Evaluations: 39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Gradient Evaluations: NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Belzile, Jennifer L. Wadsworth, Paul J. Northrop, Scott D. Grimshaw, Raphael Huser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

